<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.24.1"/><meta name="description" content="One of the things that i have always been bad at is networking, and i during my interneting i stumbled upon a blog post talking about DNS. So i decided i would create a DNS client in Rust. So might write a couple of post about my adventures writing it. This post explains a lot of basics" data-gatsby-head="true"/><meta property="og:title" content="A DNS-message breakdown no one asked for" data-gatsby-head="true"/><meta property="og:description" content="One of the things that i have always been bad at is networking, and i during my interneting i stumbled upon a blog post talking about DNS. So i decided i would create a DNS client in Rust. So might write a couple of post about my adventures writing it. This post explains a lot of basics" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta name="twitter:card" content="summary" data-gatsby-head="true"/><meta name="twitter:creator" content="tandolf" data-gatsby-head="true"/><meta name="twitter:title" content="A DNS-message breakdown no one asked for" data-gatsby-head="true"/><meta name="twitter:description" content="One of the things that i have always been bad at is networking, and i during my interneting i stumbled upon a blog post talking about DNS. So i decided i would create a DNS client in Rust. So might write a couple of post about my adventures writing it. This post explains a lot of basics" data-gatsby-head="true"/><style data-href="/styles.8c1f2202249a84235a8e.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--global-font-size:15px;--global-line-height:1.4em;--global-space:10px;--font-stack:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--mono-font-stack:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--background-color:#fff;--page-width:60em;--font-color:#151515;--invert-font-color:#fff;--primary-color:#1a95e0;--secondary-color:#727578;--error-color:#d20962;--progress-bar-background:#727578;--progress-bar-fill:#151515;--code-bg-color:#e8eff2;--input-style:solid;--display-h1-decoration:none}*{box-sizing:border-box;text-rendering:geometricPrecision}::selection{background:var(--primary-color);color:var(--invert-font-color)}body{word-wrap:break-word;background-color:var(--background-color);color:var(--font-color);font-family:var(--font-stack);font-size:var(--global-font-size);margin:0}.logo,body,h1,h2,h3,h4,h5,h6{line-height:var(--global-line-height)}a{color:var(--primary-color);cursor:pointer;text-decoration:none}a:hover{background-color:var(--primary-color);color:var(--invert-font-color)}em{color:var(--font-color);font-family:var(--font-stack);font-size:var(--global-font-size);font-style:italic}blockquote,code,em,strong{line-height:var(--global-line-height)}.logo,blockquote,code,footer,h1,h2,h3,h4,h5,h6,header,li,ol,p,section,ul{float:none;margin:0;padding:0}.logo,blockquote,h1,ol,p,ul{margin-bottom:calc(var(--global-space)*2);margin-top:calc(var(--global-space)*2)}.logo,h1{display:inline-block;display:table-cell;font-weight:600;margin:0;overflow:hidden;padding:calc(var(--global-space)*2) 0 calc(var(--global-space)*2);position:relative}h1:after{bottom:5px;content:"====================================================================================================";display:var(--display-h1-decoration);left:0;position:absolute}.logo+*,h1+*{margin-top:0}h2,h3,h4,h5,h6{font-weight:600;margin-bottom:var(--global-line-height);position:relative}blockquote{overflow:hidden;padding-left:2ch;position:relative}blockquote:after{color:#9ca2ab;content:">\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>";left:0;line-height:var(--global-line-height);position:absolute;top:0;white-space:pre}code{background-color:var(--code-bg-color);font-family:var(--mono-font-stack);font-weight:inherit}code:after,code:before{content:"`";display:inline}pre code:after,pre code:before{content:""}pre{word-wrap:break-word;background-color:var(--background-color);border:1px solid var(--secondary-color);color:var(--secondary-color);display:block;padding:var(--global-space);white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-break:break-all}pre code{display:inline-block;font-family:var(--mono-font-stack);margin:0;min-width:100%;overflow-x:scroll;padding:0}.terminal .logo,.terminal blockquote,.terminal code,.terminal h1,.terminal h2,.terminal h3,.terminal h4,.terminal h5,.terminal h6,.terminal strong{color:var(--font-color);font-family:var(--font-stack);font-size:var(--global-font-size);font-style:normal}.terminal-prompt{position:relative;white-space:nowrap}.terminal-prompt:before{content:"> "}.terminal-prompt:after{-webkit-animation:cursor .8s infinite;animation:cursor .8s infinite;background:var(--primary-color);border-radius:0;bottom:-2px;content:"";display:inline-block;height:1em;margin-left:.2em;position:relative;width:3px}@-webkit-keyframes cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}li,li>ul>li{display:block;padding-left:calc(var(--global-space)*2);position:relative}nav>ul>li{padding-left:0}li:after{left:0;position:absolute;top:0}ul>li:after{content:"-"}nav ul>li:after{content:""}ol li:before{content:counters(item,".") ". ";counter-increment:item}ol ol li:before{content:counters(item,".") " ";counter-increment:item}.terminal-menu li:after,.terminal-menu li:before{display:none}ol{counter-reset:item}ol li:nth-child(n+10):after{left:-7px}ol ol{margin-bottom:0;margin-top:0}.terminal-menu{width:100%}.terminal-nav{align-items:flex-start;display:flex;flex-direction:column}ul ul{margin-bottom:0;margin-top:0}.terminal-menu ul{display:flex;flex-direction:column;flex-grow:1;font-size:var(--global-font-size);list-style-type:none;margin-top:0;padding:0!important;width:100%}.terminal-menu li{display:flex;margin:0 0 .5em;padding:0}ol.terminal-toc li{border-bottom:1px dotted var(--secondary-color);margin-bottom:15px;padding:0}.terminal-menu li:last-child{margin-bottom:0}ol.terminal-toc li a{background:var(--background-color);margin:4px 4px 4px 0;padding-right:4px;position:relative;text-align:left;top:6px}.terminal-menu li a:not(.btn){border:none;color:var(--secondary-color);display:block;text-decoration:none;width:100%}.terminal-menu li a.active{color:var(--font-color)}.terminal-menu li a:hover{background:0 0;color:inherit}ol.terminal-toc li:before{background:var(--background-color);bottom:-8px;content:counters(item,".") ". ";counter-increment:item;padding:4px 0 4px 4px;position:absolute;right:0}ol.terminal-toc li a:hover{background:var(--primary-color);color:var(--invert-font-color)}hr{border:0;border-bottom:1px dashed var(--secondary-color);margin:calc(var(--global-space)*4) 0;overflow:hidden;position:relative}p{color:var(--global-font-color);margin:0 0 var(--global-line-height)}.container{max-width:var(--page-width)}.container,.container-fluid{margin:0 auto;padding:0 calc(var(--global-space)*2)}img{width:100%}.progress-bar{background-color:var(--progress-bar-background);height:8px;margin:12px 0}.progress-bar.progress-bar-show-percent{margin-top:38px}.progress-bar-filled{background-color:var(--progress-bar-fill);height:100%;position:relative;transition:width .3s ease;width:0}.progress-bar-filled:before{border:6px solid transparent;border-top:6px solid var(--progress-bar-fill);content:"";position:absolute;right:-6px;top:-12px}.progress-bar-filled:after{border:6px solid transparent;color:var(--progress-bar-fill);content:attr(data-filled);display:block;font-size:12px;position:absolute;right:0;top:-38px;-webkit-transform:translateX(50%);transform:translateX(50%);white-space:nowrap}.progress-bar-no-arrow>.progress-bar-filled:after,.progress-bar-no-arrow>.progress-bar-filled:before{content:"";display:none;opacity:0;visibility:hidden}table{border-collapse:collapse;color:var(--font-color);font-size:var(--global-font-size);margin:var(--global-line-height) 0;width:100%}table td,table th{border:1px solid var(--font-color);font-size:1em;line-height:var(--global-line-height);padding:calc(var(--global-space)/2);vertical-align:top}table thead th{font-size:1em}table tfoot tr th{font-weight:500}table caption{font-size:1em;margin:0 0 1em}table tbody td:first-child{color:var(--secondary-color);font-weight:700}.form{width:100%}fieldset{border:1px solid var(--font-color);padding:1em}label{color:var(--font-color);font-size:1em}input[type=email],input[type=number],input[type=password],input[type=search],input[type=text]{-webkit-appearance:none;border:1px var(--input-style) var(--font-color);border-radius:0;font-family:var(--font-stack);font-size:1em;padding:.7em .5em;width:100%}input[type=email]:active,input[type=email]:focus,input[type=number]:active,input[type=number]:focus,input[type=password]:active,input[type=password]:focus,input[type=search]:active,input[type=search]:focus,input[type=text]:active,input[type=text]:focus{-webkit-appearance:none;border:1px solid var(--font-color);outline:0}input[type=email]:not(:placeholder-shown):invalid,input[type=number]:not(:placeholder-shown):invalid,input[type=password]:not(:placeholder-shown):invalid,input[type=search]:not(:placeholder-shown):invalid,input[type=text]:not(:placeholder-shown):invalid{border-color:var(--error-color)}input,textarea{background-color:var(--background-color);color:var(--font-color)}input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:var(--secondary-color)!important;opacity:1}input::placeholder,textarea::placeholder{color:var(--secondary-color)!important;opacity:1}textarea{-webkit-appearance:none;border:1px var(--input-style) var(--font-color);border-radius:0;font-family:var(--font-stack);font-size:1em;height:auto;padding:.5em;resize:none;width:100%}textarea:focus{-webkit-appearance:none;border:1px solid var(--font-color);outline:0}textarea:not(:placeholder-shown):invalid{border-color:var(--error-color)}input:-webkit-autofill,input:-webkit-autofill:focus textarea:-webkit-autofill,input:-webkit-autofill:hover,select:-webkit-autofill,select:-webkit-autofill:focus,select:-webkit-autofill:hover,textarea:-webkit-autofill:hover textarea:-webkit-autofill:focus{-webkit-text-fill-color:var(--font-color);border:1px solid var(--font-color);box-shadow:0 0 0 1000px var(--invert-font-color) inset;-webkit-box-shadow:0 0 0 1000px var(--invert-font-color) inset;-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}.form-group{margin-bottom:var(--global-line-height);overflow:auto}.btn{align-items:center;border-style:solid;border-width:1px;cursor:pointer;display:inline-flex;font-family:inherit;font-size:1em;justify-content:center;outline:0;padding:.65em 2em;position:relative;-webkit-user-select:none;user-select:none;z-index:1}.btn:active{box-shadow:none}.btn.btn-ghost{background-color:transparent;border-color:var(--font-color);color:var(--font-color)}.btn.btn-ghost:focus,.btn.btn-ghost:hover{border-color:var(--tertiary-color);color:var(--tertiary-color);z-index:2}.btn.btn-ghost:hover{background-color:transparent}.btn-block{display:flex;width:100%}.btn-default{background-color:var(--font-color);border-color:var(--invert-font-color);color:var(--invert-font-color)}.btn-default:focus:not(.btn-ghost),.btn-default:hover{background-color:var(--secondary-color);color:var(--invert-font-color)}.btn-default.btn-ghost:focus,.btn-default.btn-ghost:hover{border-color:var(--secondary-color);color:var(--secondary-color);z-index:2}.btn-error{background-color:var(--error-color);border:1px solid var(--error-color);color:var(--invert-font-color)}.btn-error:focus:not(.btn-ghost),.btn-error:hover{background-color:var(--error-color);border-color:var(--error-color)}.btn-error.btn-ghost,.btn-error.btn-ghost:focus,.btn-error.btn-ghost:hover{border-color:var(--error-color);color:var(--error-color)}.btn-error.btn-ghost:focus,.btn-error.btn-ghost:hover{z-index:2}.btn-primary{background-color:var(--primary-color);border:1px solid var(--primary-color);color:var(--invert-font-color)}.btn-primary:focus:not(.btn-ghost),.btn-primary:hover{background-color:var(--primary-color);border-color:var(--primary-color)}.btn-primary.btn-ghost,.btn-primary.btn-ghost:focus,.btn-primary.btn-ghost:hover{border-color:var(--primary-color);color:var(--primary-color)}.btn-primary.btn-ghost:focus,.btn-primary.btn-ghost:hover{z-index:2}.btn-small{font-size:.9em!important;padding:.5em 1.3em!important}.btn-group{overflow:auto}.btn-group .btn{float:left}.btn-group .btn-ghost:not(:first-child){margin-left:-1px}.terminal-card{border:1px solid var(--secondary-color)}.terminal-card>header{background-color:var(--secondary-color);color:var(--invert-font-color);padding:.5em 0;text-align:center}.terminal-card>div:first-of-type{padding:var(--global-space)}.terminal-timeline{padding-left:70px;position:relative}.terminal-timeline:before{background:var(--secondary-color);content:" ";display:inline-block;height:100%;left:35px;position:absolute;width:2px;z-index:400}.terminal-timeline .terminal-card{margin-bottom:25px}.terminal-timeline .terminal-card:before{background:var(--invert-font-color);border:2px solid var(--secondary-color);content:" ";display:inline-block;height:15px;left:26px;margin-top:25px;position:absolute;width:15px;z-index:400}.terminal-alert{border:1px solid var(--font-color);color:var(--font-color);margin-bottom:var(--global-space);padding:1em}.terminal-alert-error{border-color:var(--error-color);color:var(--error-color)}.terminal-alert-primary{border-color:var(--primary-color);color:var(--primary-color)}@media screen and (max-width:960px){label{display:block;width:100%}pre::-webkit-scrollbar{height:3px}}@media screen and (max-width:480px){form{width:100%}}@media only screen and (min-width:30em){.terminal-menu ul,.terminal-nav{align-items:center;flex-direction:row}.terminal-menu ul{justify-content:flex-end;justify-items:flex-end;margin-top:calc(var(--global-space)*2)}.terminal-menu li{margin:0 2em 0 0}.terminal-menu li:last-child{margin-right:0}}.terminal-media:not(:last-child){margin-bottom:1.25rem}.terminal-media-left{padding-right:var(--global-space)}.terminal-media-left,.terminal-media-right{display:table-cell;vertical-align:top}.terminal-media-right{padding-left:var(--global-space)}.terminal-media-body{display:table-cell;vertical-align:top}.terminal-media-heading{font-size:1em;font-weight:700}.terminal-media-content{margin-top:.3rem}.terminal-placeholder{background-color:var(--secondary-color);border:1px solid var(--secondary-color);color:var(--font-color);font-size:1rem;text-align:center}figure>img{padding:0}.terminal-avatarholder{height:calc(var(--global-space)*5);width:calc(var(--global-space)*5)}.terminal-avatarholder img{padding:0}figure{margin:0}figure>figcaption{color:var(--secondary-color);text-align:center}.hljs{background:var(--block-background-color);color:var(--font-color);display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-quote{color:var(--secondary-color)}.hljs-variable{color:var(--font-color)}.hljs-built_in,.hljs-keyword,.hljs-name,.hljs-selector-tag,.hljs-tag{color:var(--primary-color)}.hljs-addition,.hljs-attribute,.hljs-literal,.hljs-section,.hljs-string,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type{color:var(--secondary-color)}.hljs-deletion,.hljs-meta,.hljs-selector-attr,.hljs-selector-pseudo{color:var(--primary-color)}.hljs-doctag{color:var(--secondary-color)}.hljs-attr,.hljs-bullet,.hljs-link,.hljs-symbol{color:var(--primary-color)}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><title data-gatsby-head="true">A DNS-message breakdown no one asked for | Gatsby Starter Blog</title><style data-styled="" data-styled-version="5.3.6">.fhWNNh{border-left-width:8px;border-left-style:solid;border-left-color:var(--primary-color);border-radius :5px;background-color:transparent;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px 16px 0px 16px;margin-bottom:21px;color:var(--font-color);}/*!sc*/
.fhWNNh div{font-size:22px;line-height:1.2em;}/*!sc*/
.fhWNNh em{color:var(--font-color);}/*!sc*/
.fhWNNh a{-webkit-text-decoration:underline;text-decoration:underline;color:var(--font-color);}/*!sc*/
.copXrJ{border-left-width:8px;border-left-style:solid;border-left-color:var(--dark-warning-color);border-radius :5px;background-color:var(--warning-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;padding:16px 16px 0px 16px;margin-bottom:21px;color:var(--font-dark-color);}/*!sc*/
.copXrJ div{font-size:undefinedpx;line-height:1.2em;}/*!sc*/
.copXrJ em{color:var(--font-dark-color);}/*!sc*/
.copXrJ a{-webkit-text-decoration:underline;text-decoration:underline;color:var(--font-dark-color);}/*!sc*/
data-styled.g1[id="AttentionBox__StyledWrapper-sc-y20oae-0"]{content:"fhWNNh,copXrJ,"}/*!sc*/
.gRbVsB{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-transform:uppercase;font-weight:bolder;margin-bottom:5px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}/*!sc*/
data-styled.g2[id="AttentionBox__Header-sc-y20oae-1"]{content:"gRbVsB,"}/*!sc*/
.hlSmGI{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-style:italic;font-weight:bolder;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-webkit-justify-content:end;-ms-flex-pack:end;justify-content:end;font-size:16px;}/*!sc*/
data-styled.g3[id="AttentionBox__Footer-sc-y20oae-2"]{content:"hlSmGI,"}/*!sc*/
.fWYNwT code{padding-left:5px;padding-right:5px;background-color:green;}/*!sc*/
data-styled.g4[id="AttentionBox__Content-sc-y20oae-3"]{content:"fWYNwT,"}/*!sc*/
.facmim{margin-right:7px;margin-bottom:0px;}/*!sc*/
data-styled.g5[id="AttentionBox__Icon-sc-y20oae-4"]{content:"facmim,"}/*!sc*/
.crIFBs{border-radius :5px;background-color:var(--header-font-color);display:inline-block;margin-right:6px;}/*!sc*/
data-styled.g7[id="Tag__StyledWrapper-sc-1wufizg-0"]{content:"crIFBs,"}/*!sc*/
.cjpKMj{font-size:14px;text-align:center;margin:2px 10px 2px;}/*!sc*/
data-styled.g8[id="Tag__Text-sc-1wufizg-1"]{content:"cjpKMj,"}/*!sc*/
.dnVzXH{margin-bottom:10px;}/*!sc*/
data-styled.g9[id="tagSection__StyledWrapper-sc-1aa460q-0"]{content:"dnVzXH,"}/*!sc*/
:root{--global-font-size:20px;--global-line-height:1.4em;--global-space:10px;--font-stack:Ubuntu Mono,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--mono-font-stack:Ubuntu Mono,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--background-color:#222225;--page-width:60em;--font-color:#e8e9ed;--font-dark-color:#151515;--header-font-color:#7a3496;--color-gray-700:#BFDBF7;--color-tertiary:#ffdf2c;--invert-font-color:#222225;--secondary-color:#1F7A8C;--tertiary-color:#a3abba;--primary-color:#62c4ff;--error-color:#A31621;--info-color:#62c4ff;--dark-info-color:#0DA2FB;--warning-color:#c7b02c;--dark-warning-color:#766400;--danger-color:#A31621;--dark-danger-color:#580006;--progress-bar-background:#3f3f44;--progress-bar-fill:#62c4ff;--code-bg-color:#3f3f44;--input-style:solid;--display-h1-decoration:none;--spacing-4:4rem;--spacing-0:0;--spacing-16:4rem;}/*!sc*/
body{background-color:var(--background-color);color:var(--font-color);}/*!sc*/
ol li::before{list-style-type:none;margin:0;padding:0;}/*!sc*/
.no-line::after{content:none;}/*!sc*/
code::after,code::before{content:none;}/*!sc*/
.mermaid{margin-top:4em;margin-bottom:4em;}/*!sc*/
.bio-avatar{margin-right:var(--spacing-4);margin-bottom:var(--spacing-0);min-width:50px;border-radius:100%;}/*!sc*/
.bio{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:var(--spacing-16);}/*!sc*/
.bio p{margin-top:0.8em;margin-bottom:var(--spacing-0);}/*!sc*/
h1{display:block;margin-top:150px;font-size:46px;margin-bottom:5px;}/*!sc*/
h2{margin-top:150px;margin-bottom:15px;font-size:36px;}/*!sc*/
h3{margin-bottom:2px;color:var(--dark-warning-color);font-size:26px;}/*!sc*/
h4{margin-bottom:2px;}/*!sc*/
p span{margin-top:30px !important;margin-bottom:30px !important;}/*!sc*/
ol li::before{display:inline;}/*!sc*/
data-styled.g12[id="sc-global-kRUHyZ1"]{content:"sc-global-kRUHyZ1,"}/*!sc*/
.gHswLm{font-size:14px;padding-bottom:10px;}/*!sc*/
data-styled.g13[id="footer__FooterText-sc-ora8l1-0"]{content:"gHswLm,"}/*!sc*/
.kLqMAm{margin:0 auto;max-width:70rem;background-color:var(--background-color);color:var(--font-color);}/*!sc*/
data-styled.g14[id="layout__Wrapper-sc-omnq36-0"]{content:"kLqMAm,"}/*!sc*/
.jJcppV{font-size:18px;}/*!sc*/
data-styled.g15[id="styles__LinkText-sc-ncn1p3-0"]{content:"jJcppV,"}/*!sc*/
.bqQJTT{font-size:18px;color:var(--color-gray-700);}/*!sc*/
data-styled.g16[id="styles__DateText-sc-ncn1p3-1"]{content:"bqQJTT,"}/*!sc*/
</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=a93fb0266df267ec6acb2d350ad1fe0f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout__Wrapper-sc-omnq36-0 kLqMAm"><header class="terminal-nav"><div class="terminal-logo"><div class="logo terminal-prompt"><a class="menu-item" href="/">/home/toerktumlare/</a></div></div><nav class="terminal-menu"><ul><li><a class="menu-item" href="/">/home</a></li><li><a class="menu-item" href="/about">/about</a></li></ul></nav></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header style="margin-bottom:30px"><h1 itemProp="headline">A DNS-message breakdown no one asked for</h1><h3 class="styles__DateText-sc-ncn1p3-1 bqQJTT">November 10, 2023</h3><div class="tagSection__StyledWrapper-sc-1aa460q-0 dnVzXH"><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->rust</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->binary</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->networking</p></div></div></header><section itemProp="articleBody"><p>I like to just randomly spend my time on the internet, and every once in a while
i stumble upon interesting blog posts. I have for a very long time considered
myself really bad at everything related to networking.</p>
<p>I found this blog post about how you would go about to write a DNS client. I just
glanced through it without looking at any implementations, and then decided to
look up the RFC and suddenly had this feeling that… i could write a client myself.</p>
<p>Julia Evans at <a href="https://wizardzines.com/comics/dns-packet/">wizard zines</a> makes
these amazing comics and she had this image that showed what a DNS
request/response looked like and it looked so simple.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c0bc94b659686e9aa955363c492f9951/b4098/dns-packet.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64.55696202531645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACX0lEQVQ4y22T6XKkMAyE8/4Pl2zVTI65J4HhxtgD+MDAt2tPsvtnVeUSNrKsbrWeyrKkKAqu1yvGGKSUdF1H0zQIIRjHEaVU3LdtS9/3MTZ8D8MQfYi73+8EewoX3t/fORwOaK1JkoTn5+e4Pj4+or9cLry9vXE+nzmdTry8vES/3W55fX1lu32lrutHQv5jy7xgjcV7HysM+3VZmb1nnn2MCf+sdcCK9xPrsjwSBphZlhGgV1WFkhLjHXqy5KolvwsaKeh6hXEzxi2MxlN1jlulEXLE+RVtF+Z5+Qd5u93w+fngUQyKrCzQ6o6qW8q6Iq9KxGBp2w4hOsZaUlcNaZo+OO4GJr88IIfDX5sPztcbgzaxot1+T5Fl3JWMCL5uCb311FVFknxxlyLCrm4Jl9OB8zXBzytP0zRxPB5Js4LjOaFKbxRNyf6wJ88y6qrGTxPaWZR28Sw08JakdK3ATRPzPKPt/KgwyCB0L5jTIzr/YrCapm1ZeoNuJN463OzpBhuVIOoGrMeNmjzPcc5ip+Uf5B9b1zV67R21aMiLnLzMSbIUNfYMZo58ZbcbY6dwg8Zay7zMaOMfCZdlwTkXxfnT6SDStm44HI98Xq+czidGrTFu/SvmSQ54YxGy4/204zPNHxyGF3e7XeQxCHmz2cSkgduoyWX5u4I0QnxoYnNJadIc0QryukSEB0LCUHIYtTAhYRqCDxWEDv4oIIzaLcto5UBR5BwOe5SS9EphjEbJDm2/IQfeQpdCgkD48q34Hz7Dg6Fx1hpGM9OIgbKW9ONErz2D9vR6QvYT/o+wfwPJJdwIvbPm6wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="DNS packet"
        title="DNS packet"
        src="/static/c0bc94b659686e9aa955363c492f9951/f058b/dns-packet.png"
        srcset="/static/c0bc94b659686e9aa955363c492f9951/c26ae/dns-packet.png 158w,
/static/c0bc94b659686e9aa955363c492f9951/6bdcf/dns-packet.png 315w,
/static/c0bc94b659686e9aa955363c492f9951/f058b/dns-packet.png 630w,
/static/c0bc94b659686e9aa955363c492f9951/b4098/dns-packet.png 816w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>So in this blog posts and maybe some additional blog posts i will write about
all the things i learnt during the development of my dns client <a href="https://github.com/Tandolf/who">Who are
you?</a> written in rust. Some thing might be
specification related related, and others might be coding/implementation
related. For instance how i solved certain problems in code.</p>
<h2>What is DNS (Domain Name System)?</h2>
<p>Like i usually do, i start out with the wikipedia explanation.</p>
<div font-size="22" class="AttentionBox__StyledWrapper-sc-y20oae-0 fhWNNh"><div class="AttentionBox__Header-sc-y20oae-1 gRbVsB"><div class="AttentionBox__Icon-sc-y20oae-4 facmim"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" style="vertical-align:middle" height="35" width="35" xmlns="http://www.w3.org/2000/svg"><path d="M464 256h-80v-64c0-35.3 28.7-64 64-64h8c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24h-8c-88.4 0-160 71.6-160 160v240c0 26.5 21.5 48 48 48h128c26.5 0 48-21.5 48-48V304c0-26.5-21.5-48-48-48zm-288 0H96v-64c0-35.3 28.7-64 64-64h8c13.3 0 24-10.7 24-24V56c0-13.3-10.7-24-24-24h-8C71.6 32 0 103.6 0 192v240c0 26.5 21.5 48 48 48h128c26.5 0 48-21.5 48-48V304c0-26.5-21.5-48-48-48z"></path></svg></div></div><div class="AttentionBox__Content-sc-y20oae-3 fWYNwT"><p>The Domain Name System (DNS) is a hierarchical and distributed naming system for
computers, services, and other resources … it translates readily memorized
domain names to the numerical IP addresses needed for locating and identifying
computer services and devices with the underlying network protocols.</p></div><div class="AttentionBox__Footer-sc-y20oae-2 hlSmGI">wikipedia</div></div>
<p>The short explanation is that the internet has no idea what web addresses are,
the internet works with ip addresses. So all over the internet there are DNS
servers that you can query with a domain name and get an ip-address back instead.
So think of DNS-servers as sort of old school phonebooks.</p>
<p>The original DNS specification is defined in the <a href="https://datatracker.ietf.org/doc/html/rfc1035">rfc 1035</a>, and we are going to reference that throughout this post.</p>
<p>There has been significate updates of the DNS protocol throughout the years. Especially with the addition of <em>DNSSEC</em> which currently is defined by <a href="https://datatracker.ietf.org/doc/html/rfc4033">rfc 4033</a>, <a href="https://datatracker.ietf.org/doc/html/rfc4034">rfc4034</a> and <a href="https://datatracker.ietf.org/doc/html/rfc4035">rfc4035</a>. <em>DNSSEC</em> wont be covered in this post as it is a big topic.</p>
<h2>Lets make a DNS Request</h2>
<p>So in order to make a dns request there are several different dns clients out
there. Im going to use the program <code>dig</code> but there are others like <code>nslookup</code>
etc.</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">➜  ~ </span><span class="token function" style="color:rgb(80, 250, 123)">dig</span><span class="token plain"> blog.toerktumlare.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span><span class="token plain"> DiG </span><span class="token number">9.18</span><span class="token plain">.18-0ubuntu0.22.04.1-Ubuntu </span><span class="token operator">&lt;&lt;</span><span class="token operator">&gt;&gt;</span><span class="token plain"> blog.toerktumlare.com</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> global options: +cmd</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> Got answer:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> -</span><span class="token operator">&gt;&gt;</span><span class="token plain">HEADER</span><span class="token operator">&lt;&lt;-</span><span class="token plain"> opcode: QUERY, status: NOERROR, id: </span><span class="token number">40955</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> flags: qr rd ra</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> QUERY: </span><span class="token number">1</span><span class="token plain">, ANSWER: </span><span class="token number">5</span><span class="token plain">, AUTHORITY: </span><span class="token number">0</span><span class="token plain">, ADDITIONAL: </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> OPT PSEUDOSECTION:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> EDNS: version: </span><span class="token number">0</span><span class="token plain">, flags:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> udp: </span><span class="token number">65494</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> QUESTION SECTION:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain">blog.toerktumlare.com.		IN	A</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> ANSWER SECTION:</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">blog.toerktumlare.com.	</span><span class="token number">3600</span><span class="token plain">	IN	CNAME	tandolf.github.io.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">tandolf.github.io.	</span><span class="token number">3600</span><span class="token plain">	IN	A	</span><span class="token number">185.199</span><span class="token plain">.108.153</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">tandolf.github.io.	</span><span class="token number">3600</span><span class="token plain">	IN	A	</span><span class="token number">185.199</span><span class="token plain">.109.153</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">tandolf.github.io.	</span><span class="token number">3600</span><span class="token plain">	IN	A	</span><span class="token number">185.199</span><span class="token plain">.110.153</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">tandolf.github.io.	</span><span class="token number">3600</span><span class="token plain">	IN	A	</span><span class="token number">185.199</span><span class="token plain">.111.153</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> Query time: </span><span class="token number">59</span><span class="token plain"> msec</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> SERVER: </span><span class="token number">127.0</span><span class="token plain">.0.53</span><span class="token comment" style="color:rgb(98, 114, 164)">#53(127.0.0.53) (UDP)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> WHEN: Sat Nov </span><span class="token number">11</span><span class="token plain"> </span><span class="token number">18</span><span class="token plain">:38:37 CET </span><span class="token number">2023</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> MSG SIZE  rcvd: </span><span class="token number">145</span><span class="token plain"></span></div></pre>
<p>So a simple DNS request on this blog returns the above information. There is a
lot of information returned, but what does the <em>actual</em> request and response
look like.</p>
<br/>
<br/>
<br/>
<br/>
<p>If we run <code>tcpdump</code> and sniff the traffic we get the following.</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">➜  ~ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> tcpdump --interface any -n port </span><span class="token number">53</span><span class="token plain"> -X</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">tcpdump: data </span><span class="token function" style="color:rgb(80, 250, 123)">link</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">type</span><span class="token plain"> LINUX_SLL2</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">tcpdump: verbose output suppressed, use -v</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">v</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">. </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> full protocol decode</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">listening on any, link-type LINUX_SLL2 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Linux cooked v2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">, snapshot length </span><span class="token number">262144</span><span class="token plain"> bytes</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">18</span><span class="token plain">:49:49.939297 lo    In  IP </span><span class="token number">127.0</span><span class="token plain">.0.1.38500 </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.53.53: </span><span class="token number">39085</span><span class="token plain">+ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">1au</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> A? blog.toerktumlare.com. </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">62</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0000:  </span><span class="token number">4500</span><span class="token plain"> 005a c2c1 0000 </span><span class="token number">4011</span><span class="token plain"> b99b 7f00 0001  E</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">Z</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0010:  7f00 0035 </span><span class="token number">9664</span><span class="token plain"> 0035 0046 fe8d 98ad 0120  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.5.d.5.F</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0020:  0001 0000 0000 0000 0462 6c6f 670c 746f  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.blog.to</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0030:  </span><span class="token number">6572</span><span class="token plain"> 6b74 756d 6c61 </span><span class="token number">7265</span><span class="token plain"> 0363 6f6d 0000  erktumlare.com</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0040:  0100 0100 0029 04d0 0000 0000 000c 000a  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0050:  0008 e157 ecab eb0d 51bd                 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.W</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">Q.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">18</span><span class="token plain">:49:49.939588 lo    In  IP </span><span class="token number">127.0</span><span class="token plain">.0.53.53 </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.1.38500: </span><span class="token number">39085</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain">/0/1 CNAME tandolf.github.io., A </span><span class="token number">185.199</span><span class="token plain">.108.153, A </span><span class="token number">185.199</span><span class="token plain">.110.153, A </span><span class="token number">185.199</span><span class="token plain">.109.153, A </span><span class="token number">185.199</span><span class="token plain">.111.153 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">145</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0000:  </span><span class="token number">4500</span><span class="token plain"> 00ad 8a61 </span><span class="token number">4000</span><span class="token plain"> 0111 f0a8 7f00 0035  E</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">a@</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0010:  7f00 0001 0035 </span><span class="token number">9664</span><span class="token plain"> 0099 fee0 98ad </span><span class="token number">8180</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.5.d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0020:  0001 0005 0000 0001 0462 6c6f 670c 746f  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.blog.to</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0030:  </span><span class="token number">6572</span><span class="token plain"> 6b74 756d 6c61 </span><span class="token number">7265</span><span class="token plain"> 0363 6f6d 0000  erktumlare.com</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0040:  0100 01c0 0c00 0500 0100 000b 6f00 </span><span class="token number">1307</span><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">o</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0050:  </span><span class="token number">7461</span><span class="token plain"> 6e64 6f6c </span><span class="token number">6606</span><span class="token plain"> </span><span class="token number">6769</span><span class="token plain"> </span><span class="token number">7468</span><span class="token plain"> </span><span class="token number">7562</span><span class="token plain"> 0269  tandolf.github.i</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0060:  6f00 c033 0001 0001 0000 0b6f 0004 b9c7  o</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.o</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0070:  6c99 c033 0001 0001 0000 0b6f 0004 b9c7  l</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.o</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0080:  6e99 c033 0001 0001 0000 0b6f 0004 b9c7  n</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.o</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0090:  6d99 c033 0001 0001 0000 0b6f 0004 b9c7  m</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.o</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x00a0:  6f99 0000 29ff d600 0000 0000 00         o</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">^C</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">2</span><span class="token plain"> packets captured</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">4</span><span class="token plain"> packets received by filter</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">0</span><span class="token plain"> packets dropped by kernel</span></div></pre>
<p>This is once again a lot of information. The first chunk, is the actual query.
While the second part is the response from the dns server.</p>
<br/>
<br/>
<br/>
<br/>
<p>So if we isolate just the query:</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token number">18</span><span class="token plain">:49:49.939297 lo    In  IP </span><span class="token number">127.0</span><span class="token plain">.0.1.38500 </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token plain">.0.53.53: </span><span class="token number">39085</span><span class="token plain">+ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">1au</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> A? blog.toerktumlare.com. </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">62</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0000:  </span><span class="token number">4500</span><span class="token plain"> 005a c2c1 0000 </span><span class="token number">4011</span><span class="token plain"> b99b 7f00 0001  E</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">Z</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">@</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0010:  7f00 0035 </span><span class="token number">9664</span><span class="token plain"> 0035 0046 fe8d 98ad 0120  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.5.d.5.F</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0020:  0001 0000 0000 0000 0462 6c6f 670c 746f  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.blog.to</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0030:  </span><span class="token number">6572</span><span class="token plain"> 6b74 756d 6c61 </span><span class="token number">7265</span><span class="token plain"> 0363 6f6d 0000  erktumlare.com</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0040:  0100 0100 0029 04d0 0000 0000 000c 000a  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">	0x0050:  0008 e157 ecab eb0d 51bd                 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">.W</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">..</span><span class="token plain">Q.</span></div></pre>
<p>We see that there is some text and just a bunch of different hex numbers. Out of
all these hex numbers we need first start to discard all the things we don’t
need. The first <code>20 bytes</code> is the ipv4 header so we can discard that.</p>
<p>The ipv4 header:</p>
<pre class="prism-code language-" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">  4500 005a c2c1 0000 4011 b99b 7f00 0001 7f00 0035</span></div></pre>
<p>The next <code>8 bytes</code> after that is the <em>UDP Header</em>. And already we learnt
something, and that is that <strong>DNS is sent over UDP</strong>. You have to remember that the
original DNS specification is from November 1987, it was in the early days of
the internet.</p>
<p>The UDP header:</p>
<pre class="prism-code language-" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">  9664 0035 0046 fe8d </span></div></pre>
<p>Its worth noting that the specification has been updated several times, and that
you can in fact send DNS over TCP (most DNS resolvers will accept it) and that DNSSec
has also been introduced which adds a lot of security features to the protocol.</p>
<br/>
<br/>
<br/>
<br/>
<p>So what we are left with is:</p>
<pre class="prism-code language-" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">  98ad 0120 0001 0000 0000 0001 0462 6c6f 670c 746f </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  6572 6b74 756d 6c61 7265 0363 6f6d 0000 0100 0100 </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  0029 04d0 0000 0000 000c 000a 0008 e157 ecab eb0d </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">  51bd</span></div></pre>
<p>And this ladies and gentlemen is our raw dns request!</p>
<h2>Anatomy of a DNS message</h2>
<p>So i think it is about time that we pull up the official dns specification and
if we look in the <em>message</em> section of the rfc, they have a very nice image
representation of what a single dns message looks like. So all in all a DNS
messages, both requests and responses, has the following general structure.</p>
<pre class="prism-code language-" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +---------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    |        Header       |</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +---------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    |       Question      | the question for the name server</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +---------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    |        Answer       | RRs answering the question</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +---------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    |      Authority      | RRs pointing toward an authority</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +---------------------+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    |      Additional     | RRs holding additional information</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +---------------------+</span></div></pre>
<p>One of the things we are going to see later is that the Header and the Question
is always going to be in the message and the responses, but depending on what
response we get back the last three sections of the message will differ.</p>
<h2>The DNS Header</h2>
<p>So we are going to start out with the header, and an image usually says more
than a 1000 words so we are going to extract an image (once again) <a href="https://datatracker.ietf.org/doc/html/rfc1035#section-4.1.1">rfc
1035</a> that shows
the overall structure of the header section.</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                    </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain">  </span><span class="token number">6</span><span class="token plain">  </span><span class="token number">7</span><span class="token plain">  </span><span class="token number">8</span><span class="token plain">  </span><span class="token number">9</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                      ID                       </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">QR</span><span class="token operator">|</span><span class="token plain">   Opcode  </span><span class="token operator">|</span><span class="token plain">AA</span><span class="token operator">|</span><span class="token plain">TC</span><span class="token operator">|</span><span class="token plain">RD</span><span class="token operator">|</span><span class="token plain">RA</span><span class="token operator">|</span><span class="token plain">   Z    </span><span class="token operator">|</span><span class="token plain">   RCODE   </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    QDCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    ANCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    NSCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    ARCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div></pre>
<p>A DNS header is always <strong>12 bytes long</strong> and contains all the metadata for the
message. This includes both information that has to do with the request, but
also information about the response, since a DNS message is actually both.</p>
<h2>Id</h2>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain">  </span><span class="token number">6</span><span class="token plain">  </span><span class="token number">7</span><span class="token plain">  </span><span class="token number">8</span><span class="token plain">  </span><span class="token number">9</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                      ID                       </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div></pre>
<p>A 16 bit identifier assigned by the program that generates the query.  This
identifier is copied over to the corresponding reply and can be used by the
requester to match up replies to outstanding queries. So if you make a lot of
requests, this id ccan help you match up what request to its corresponding
response. For instance in a async environment.</p>
<p>Our first 2 bytes have the hex number <code>98ad</code>, which converted to decimal is
<code>39085</code> so that is our id for this request.</p>
<h2>Flags</h2>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain">  </span><span class="token number">6</span><span class="token plain">  </span><span class="token number">7</span><span class="token plain">  </span><span class="token number">8</span><span class="token plain">  </span><span class="token number">9</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">QR</span><span class="token operator">|</span><span class="token plain">   Opcode  </span><span class="token operator">|</span><span class="token plain">AA</span><span class="token operator">|</span><span class="token plain">TC</span><span class="token operator">|</span><span class="token plain">RD</span><span class="token operator">|</span><span class="token plain">RA</span><span class="token operator">|</span><span class="token plain">   Z    </span><span class="token operator">|</span><span class="token plain">   RCODE   </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div></pre>
<p>Several different flags that will for instance define what type of DNS message
this is or provide instructions to the server of how you want it to process your
request. This header will also contain a response code that will tell us of the
outcome of the request (if there was an error or not etc.).</p>
<br/>
<br/>
<br/>
<br/>
<p>Lets go through all the flags one by one.</p>
<h3>- QR (Query/Response)</h3>
<p>A one bit field that specifies whether this message is a query (0), or a
response (1).</p>
<h3>- OPCODE (Operation Code)</h3>
<p>A four bit field that specifies what kind of query this message is. This value
is set by the originator of a query and copied into the response. The values
are:</p>
<p>        0               a standard query (QUERY)</p>
<p>        1               an inverse query (IQUERY)</p>
<p>        2               a server status request (STATUS)</p>
<p>        3-15            reserved for future use</p>
<h3>- AA (Authoritative Answer)</h3>
<p>this bit is valid in responses, and specifies if the responding name server is
an authority for the domain name we are asking about. Basically it denotes
if the name server we asked has <em>responsibility</em> over the domain.</p>
<p>Note that the contents of the answer section may have multiple owners because of
aliases. This AA bit corresponds to the name which matches the query name.</p>
<h3>- TC (TrunCation)</h3>
<p>Specifies that this message was truncated due to length greater than that
permitted on the transmission channel (so basically if this message was too long).</p>
<h3>- RD (Recursion Desired)</h3>
<p>This bit can be set in a query and is copied into the response. If RD is set, it
directs the name server to pursue the query recursively. So if the name server
im asking doesn’t know what the IP-address is for the domain i’m querying about,
im telling the name server to start asking around to other name servers until it
fins one that does know. This bit is usually always set, but there are some
user cases when you don’t want to do recursive lookups.</p>
<h3>- RA (Recursion Available)</h3>
<p>This be is set or cleared in a response, and denotes whether recursive query
support is available in the name server.</p>
<h3>- Z</h3>
<p>Reserved for future use.  Must be zero in all queries and responses.</p>
<h3>- RCODE (Response Code)</h3>
<p>Response code - this 4 bit field is set as part of responses.  The values have
the following interpretation:</p>
<p>0. <strong>No error condition</strong></p>
<p>1. <strong>Format error</strong> - The name server was unable to interpret the query.</p>
<p>2. <strong>Server failure</strong> - The name server was unable to process this query due to
a problem with the name server.</p>
<p>3. <strong>Name Error</strong> - Meaningful only for responses from an authoritative name server, this code
signifies that the domain name referenced in the query does not exist.</p>
<p>4. <strong>Not Implemented</strong> - The name server does not support the requested kind of query.</p>
<p>5. <strong>Refused</strong> - The name server refuses to perform the specified operation for policy
reasons. For example, a name server may not wish to provide the information to the
particular requester, or a name server may not wish to perform a particular
operation (e.g., zone transfer) for particular data.</p>
<p>6-15. <strong>Reserved for future use</strong></p>
<h2>Count Section</h2>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain">  </span><span class="token number">6</span><span class="token plain">  </span><span class="token number">7</span><span class="token plain">  </span><span class="token number">8</span><span class="token plain">  </span><span class="token number">9</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    QDCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    ANCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    NSCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                    ARCOUNT                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div></pre>
<h3>QDCOUNT (Questions Defined)</h3>
<p>an unsigned 16 bit integer specifying the number of entries in the question
section.</p>
<h3>ANCOUNT (Answers)</h3>
<p>an unsigned 16 bit integer specifying the number of resource records in the
answer section.</p>
<h3>NSCOUNT (Name Servers)</h3>
<p>an unsigned 16 bit integer specifying the number of name server resource records
in the authority records section.</p>
<h3>ARCOUNT (Additional Record)</h3>
<p>an unsigned 16 bit integer specifying the number of resource records in the
additional records section.</p>
<br/>
<br/>
<br/>
<p>The 8 bytes after the id and flags are the 4 counters represented as u16s.</p>
<pre class="prism-code language-" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">0001 0000 0000 0001</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">QDCOUNT = 1</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ANCOUNT = 0</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">NSCOUNT = 0</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ARCOUNT = 1</span></div></pre>
<p>So our counters show us that there is one <em>question</em> and one <em>additional record</em> in our message.</p>
<div class="AttentionBox__StyledWrapper-sc-y20oae-0 copXrJ"><div class="AttentionBox__Header-sc-y20oae-1 gRbVsB"><div class="AttentionBox__Icon-sc-y20oae-4 facmim"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" style="vertical-align:middle" height="25" width="25" xmlns="http://www.w3.org/2000/svg"><path d="M464 720a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"></path></svg></div>warning</div><div class="AttentionBox__Content-sc-y20oae-3 fWYNwT"><p>ARCount is commonly set to 1 indicating that there is an <em>additional record</em> included. DNS has pretty much <em>outgrown</em> its header size and there was a need to be able to include more meta information in messages so DNS was extended in <a href="https://datatracker.ietf.org/doc/html/rfc6891">rfc 6891</a> to include <em>pseudo records</em> that is used to include additional meta information in both requests and responses.</p></div></div>
<h2>DNS Question section</h2>
<p>Lastly in a standard DNS message is the actual query. THis section contains the domain name we are asking for and and the definition of what type of <em>resource records</em> we want.</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                    </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain">  </span><span class="token number">6</span><span class="token plain">  </span><span class="token number">7</span><span class="token plain">  </span><span class="token number">8</span><span class="token plain">  </span><span class="token number">9</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                                               </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /                     QNAME                     /</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    /                                               /</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                     QTYPE                     </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                     QCLASS                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div></pre>
<br/>
<br/>
<h3>QNAME (Question Name)</h3>
<p>The first part consists of a domain name which in the specification is called a <em>QNAME</em> (question name). This is a dynamically sized field with a max value of 255 bytes. The format of the data is a mixture of numbers and <em>labels</em> in the ASCII format, with each <em>label</em> of a domain name prefixed by its length.</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># format:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">&lt;</span><span class="token plain">length</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token plain">label</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token plain">length</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token plain">label</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token plain">Null</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># example:</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">3www6google3com</span></div></pre>
<br/>
<br/>
<p>So if we convert the data in our message from previous we see the following:</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># hex values</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">04 </span><span class="token number">62</span><span class="token plain"> 6c 6f </span><span class="token number">67</span><span class="token plain"> 0c </span><span class="token number">74</span><span class="token plain"> 6f </span><span class="token number">65</span><span class="token plain"> </span><span class="token number">72</span><span class="token plain"> 6b </span><span class="token number">74</span><span class="token plain"> </span><span class="token number">75</span><span class="token plain"> 6d 6c </span><span class="token number">61</span><span class="token plain"> </span><span class="token number">72</span><span class="token plain"> </span><span class="token number">65</span><span class="token plain"> 03 </span><span class="token number">63</span><span class="token plain"> 6f 6d 00</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># numeric and ascii values</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">4</span><span class="token plain">  b  l  o  g </span><span class="token number">12</span><span class="token plain">  t  o  e  r  k  t  u  m  l  a  r  e  </span><span class="token number">3</span><span class="token plain">  c  o  m NULL</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># result formatted</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">4</span><span class="token plain"> blog </span><span class="token number">12</span><span class="token plain"> toerktumlare </span><span class="token number">3</span><span class="token plain"> com NULL</span></div></pre>
<p>As you can see no dots are included, they are substituted by the length value.</p>
<br/>
<br/>
<div class="AttentionBox__StyledWrapper-sc-y20oae-0 copXrJ"><div class="AttentionBox__Header-sc-y20oae-1 gRbVsB"><div class="AttentionBox__Icon-sc-y20oae-4 facmim"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" style="vertical-align:middle" height="25" width="25" xmlns="http://www.w3.org/2000/svg"><path d="M464 720a48 48 0 1 0 96 0 48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"></path></svg></div>warning</div><div class="AttentionBox__Content-sc-y20oae-3 fWYNwT"><p>There are some size limits defined in the RFC. We are only allowed to have ASCII characters in names. Additional restriction include a length limit of 63 octets or less. This limit is actually defined because of how compression in DNS messages is implemented. Additional limits that need to be considered is 255 bytes for a single domain name and 512 bytes which is the maximum size of UDP messages.</p></div></div>
<br/>
<br/>
<br/>
<br/>
<h3>QTYPE and QCLASS</h3>
<p>The last parts of the body section of dns message is the <em>QType</em> and <em>QClass</em>.</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain">  </span><span class="token number">6</span><span class="token plain">  </span><span class="token number">7</span><span class="token plain">  </span><span class="token number">8</span><span class="token plain">  </span><span class="token number">9</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain">  </span><span class="token number">1</span><span class="token plain">  </span><span class="token number">2</span><span class="token plain">  </span><span class="token number">3</span><span class="token plain">  </span><span class="token number">4</span><span class="token plain">  </span><span class="token number">5</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                     QTYPE                     </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">|</span><span class="token plain">                     QCLASS                    </span><span class="token operator">|</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</span></div></pre>
<p>The <em>QType</em> value is the more important value of the two. This value defines what kind of record we would like to have returned. Common questions would for instance to ask for an <em>A</em> record, or maybe a <em>CNAME</em> record. Each record has a defined number, and the <a href="https://datatracker.ietf.org/doc/html/rfc1035#section-3.2.2">dns rfc specifies a list</a> of type values. Throughout the years, more types have been added for instance the <em>AAAA</em> record was added to support ipv6 was <a href="https://datatracker.ietf.org/doc/html/rfc1886">first added in December 1995</a> and later <a href="https://datatracker.ietf.org/doc/html/rfc3596">updated in October 2003</a>.</p>
<p>Lastly <em>QClass</em> was previously used to define in what type of network the query was made. It only has 4 definitions:</p>
<p>        IN                1 the Internet</p>
<p>        CS                2 the CSNET class (Obsolete - used only for examples in some obsolete RFCs)</p>
<p>        CH                3 the CHAOS class</p>
<p>        HS                4 Hesiod [Dyer 87]</p>
<p>Nowadays most of these definitions are deprecated so in a standard DNS query this value is always set to 1 to represent <em>the internet</em>.</p>
<h2>Analysing our full question</h2>
<p>So if we do a full breakdown of our request we get the following:</p>
<pre class="prism-code language-bash" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># id</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">98ad                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; 39085</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># header</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0100                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; b0000_0001 b0000_0000</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># query    = 0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># opcode   = 0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Authoritative Answer = 0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># TrunCation = 0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Recursion Desired = 1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Recursion Available = 0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Z = 0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">                                                       </span><span class="token comment" style="color:rgb(98, 114, 164)"># Response Code = 0</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"> </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># qdcount</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0001                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; One question</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># ancount</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0000                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; No answer </span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># nscount</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0000                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; No name server record</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># arcount</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0001                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; one additional record </span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># length</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">04                                                     </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; 4</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># label</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">626c 6f67                                              </span><span class="token comment" style="color:rgb(98, 114, 164)">#  =&gt; &quot;blog&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#length</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0c                                                     </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; 12</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># label</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">746f </span><span class="token number">6572</span><span class="token plain"> 6b74 756d 6c61 </span><span class="token number">7265</span><span class="token plain">                          </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; &quot;toerktumlare&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># length</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">03                                                     </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; 3</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># label</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">636f 6d                                                </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; com</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># null byte</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">00 </span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># QType</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0001                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; A-record </span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#QClass</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0001                                                   </span><span class="token comment" style="color:rgb(98, 114, 164)"># =&gt; IN (internet)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># OPT resource record (rfc6891)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">0000 </span><span class="token number">2904</span><span class="token plain"> d000 0000 0000 0c00 0a00 08e1 57ec abeb 0d51 bd</span></div></pre>
<h2>OPT RR-Record</h2>
<p>The last bytes in our DNS message is what is called an <em>optional resource record</em> and is an extension that was added to expand on the capabilities of DNS. This feature is OPTIONAL and <code>dig</code> uses this feature when doing requests. As it is optional, means that most DNS servers will accept queries without this additional resource record.</p>
<h2>Message compression</h2>
<p>There is some compression actually built into the DNS format to send smaller
messages. And im not going to explain how it works in this blog post but there
might be a separate post about it with a code example of how to solve the
compression in DNS messages.</p>
<h1>Final Thoughts</h1>
<p>DNS is a fascinating protocol that is used all over the internet. It has been expanded many times, and you can sense a lot of the <em>old internet</em> within the protocol. By breaking down these messages, i managed to learn a lot more about DNS and networking in general.</p>
<p>You are welcome to check out my simple implementation of my basic dns client <a href="https://www.github.com/tandolf/who">Who are you?</a> written in rust.</p></section><div class="tagSection__StyledWrapper-sc-1aa460q-0 dnVzXH"><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->rust</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->binary</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->networking</p></div></div><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#181818;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/688f707e139e1c5b3b1adc848f4464fb/d4bf4/selfie.avif 50w,/static/688f707e139e1c5b3b1adc848f4464fb/ee81f/selfie.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/688f707e139e1c5b3b1adc848f4464fb/3faea/selfie.webp 50w,/static/688f707e139e1c5b3b1adc848f4464fb/6a679/selfie.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg" data-srcset="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg 50w,/static/688f707e139e1c5b3b1adc848f4464fb/64618/selfie.jpg 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/688f707e139e1c5b3b1adc848f4464fb/d4bf4/selfie.avif 50w,/static/688f707e139e1c5b3b1adc848f4464fb/ee81f/selfie.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/688f707e139e1c5b3b1adc848f4464fb/3faea/selfie.webp 50w,/static/688f707e139e1c5b3b1adc848f4464fb/6a679/selfie.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg" srcSet="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg 50w,/static/688f707e139e1c5b3b1adc848f4464fb/64618/selfie.jpg 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><p>Written by <strong>Thomas Andolf</strong> <!-- -->I dont have twitter but i have<!-- --> <a href="https://www.linkedin.com/in/thomas-andolf-60966534">linkedin</a> <!-- -->and im on<!-- --> <a href="https://stackoverflow.com/users/1840146">stack overflow</a>.</p></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/base64-in-rust/"><h3 class="styles__LinkText-sc-ncn1p3-0 jJcppV">← <!-- -->Implementing base64 in rust</h3></a></li><li></li></ul></nav></main><footer><h3 class="footer__FooterText-sc-ora8l1-0 gHswLm">© <!-- -->2023<!-- -->, Built by<!-- --> <a href="http://www.github.com/tandolf">toerktumlare</a></h3></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/anatomy-of-dns/";window.___webpackCompilationHash="9b9b2e573e4fa6e6cb45";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-afa68794cf9a69af341a.js"],"app":["/app-66ebf82eb511e4824d72.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-6036be1a08e62eb825b9.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-72b717bd1ae7437cf1cd.js"],"component---src-pages-index-tsx":[],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-anatomy-of-dns-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-anatomy-of-dns-index-mdx-0979d3b4f78a5bb3a002.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-base-64-in-rust-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-base-64-in-rust-index-mdx-de79bbbaf811af23ea18.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-cve-2020-0601-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-cve-2020-0601-index-mdx-6e065da63338c67b563c.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-hello-world-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-hello-world-index-mdx-da239a0014ab7f34b5e1.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-monad-in-java-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-monad-in-java-index-mdx-ba07fbb206a4681465a3.js"]};/*]]>*/</script><script src="/polyfill-afa68794cf9a69af341a.js" nomodule=""></script><script src="/app-66ebf82eb511e4824d72.js" async=""></script><script src="/framework-20708a169de42a473112.js" async=""></script><script src="/webpack-runtime-ae075a3322801ba1e09b.js" async=""></script></body></html>