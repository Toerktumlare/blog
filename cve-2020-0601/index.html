<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.24.1"/><meta name="description" content="Monday the 13th of January Brian Krebs published that he had sources telling him that the day after Microsoft would release software updates that would fix a vulnerability in the Windows Crypto API. The day after on the 14th of January, NSA released a cybersecurity advisory that disclosed a vulnerability exactly there. It turned out to be very dangerous exploit that was patched. This is the story about Curveball." data-gatsby-head="true"/><meta property="og:title" content="What was CVE 2020–0601 aka. Curveball?" data-gatsby-head="true"/><meta property="og:description" content="Monday the 13th of January Brian Krebs published that he had sources telling him that the day after Microsoft would release software updates that would fix a vulnerability in the Windows Crypto API. The day after on the 14th of January, NSA released a cybersecurity advisory that disclosed a vulnerability exactly there. It turned out to be very dangerous exploit that was patched. This is the story about Curveball." data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta name="twitter:card" content="summary" data-gatsby-head="true"/><meta name="twitter:creator" content="tandolf" data-gatsby-head="true"/><meta name="twitter:title" content="What was CVE 2020–0601 aka. Curveball?" data-gatsby-head="true"/><meta name="twitter:description" content="Monday the 13th of January Brian Krebs published that he had sources telling him that the day after Microsoft would release software updates that would fix a vulnerability in the Windows Crypto API. The day after on the 14th of January, NSA released a cybersecurity advisory that disclosed a vulnerability exactly there. It turned out to be very dangerous exploit that was patched. This is the story about Curveball." data-gatsby-head="true"/><style data-href="/styles.8c1f2202249a84235a8e.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--global-font-size:15px;--global-line-height:1.4em;--global-space:10px;--font-stack:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--mono-font-stack:Menlo,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--background-color:#fff;--page-width:60em;--font-color:#151515;--invert-font-color:#fff;--primary-color:#1a95e0;--secondary-color:#727578;--error-color:#d20962;--progress-bar-background:#727578;--progress-bar-fill:#151515;--code-bg-color:#e8eff2;--input-style:solid;--display-h1-decoration:none}*{box-sizing:border-box;text-rendering:geometricPrecision}::selection{background:var(--primary-color);color:var(--invert-font-color)}body{word-wrap:break-word;background-color:var(--background-color);color:var(--font-color);font-family:var(--font-stack);font-size:var(--global-font-size);margin:0}.logo,body,h1,h2,h3,h4,h5,h6{line-height:var(--global-line-height)}a{color:var(--primary-color);cursor:pointer;text-decoration:none}a:hover{background-color:var(--primary-color);color:var(--invert-font-color)}em{color:var(--font-color);font-family:var(--font-stack);font-size:var(--global-font-size);font-style:italic}blockquote,code,em,strong{line-height:var(--global-line-height)}.logo,blockquote,code,footer,h1,h2,h3,h4,h5,h6,header,li,ol,p,section,ul{float:none;margin:0;padding:0}.logo,blockquote,h1,ol,p,ul{margin-bottom:calc(var(--global-space)*2);margin-top:calc(var(--global-space)*2)}.logo,h1{display:inline-block;display:table-cell;font-weight:600;margin:0;overflow:hidden;padding:calc(var(--global-space)*2) 0 calc(var(--global-space)*2);position:relative}h1:after{bottom:5px;content:"====================================================================================================";display:var(--display-h1-decoration);left:0;position:absolute}.logo+*,h1+*{margin-top:0}h2,h3,h4,h5,h6{font-weight:600;margin-bottom:var(--global-line-height);position:relative}blockquote{overflow:hidden;padding-left:2ch;position:relative}blockquote:after{color:#9ca2ab;content:">\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>\A>";left:0;line-height:var(--global-line-height);position:absolute;top:0;white-space:pre}code{background-color:var(--code-bg-color);font-family:var(--mono-font-stack);font-weight:inherit}code:after,code:before{content:"`";display:inline}pre code:after,pre code:before{content:""}pre{word-wrap:break-word;background-color:var(--background-color);border:1px solid var(--secondary-color);color:var(--secondary-color);display:block;padding:var(--global-space);white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-break:break-all}pre code{display:inline-block;font-family:var(--mono-font-stack);margin:0;min-width:100%;overflow-x:scroll;padding:0}.terminal .logo,.terminal blockquote,.terminal code,.terminal h1,.terminal h2,.terminal h3,.terminal h4,.terminal h5,.terminal h6,.terminal strong{color:var(--font-color);font-family:var(--font-stack);font-size:var(--global-font-size);font-style:normal}.terminal-prompt{position:relative;white-space:nowrap}.terminal-prompt:before{content:"> "}.terminal-prompt:after{-webkit-animation:cursor .8s infinite;animation:cursor .8s infinite;background:var(--primary-color);border-radius:0;bottom:-2px;content:"";display:inline-block;height:1em;margin-left:.2em;position:relative;width:3px}@-webkit-keyframes cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}@keyframes cursor{0%{opacity:0}50%{opacity:1}to{opacity:0}}li,li>ul>li{display:block;padding-left:calc(var(--global-space)*2);position:relative}nav>ul>li{padding-left:0}li:after{left:0;position:absolute;top:0}ul>li:after{content:"-"}nav ul>li:after{content:""}ol li:before{content:counters(item,".") ". ";counter-increment:item}ol ol li:before{content:counters(item,".") " ";counter-increment:item}.terminal-menu li:after,.terminal-menu li:before{display:none}ol{counter-reset:item}ol li:nth-child(n+10):after{left:-7px}ol ol{margin-bottom:0;margin-top:0}.terminal-menu{width:100%}.terminal-nav{align-items:flex-start;display:flex;flex-direction:column}ul ul{margin-bottom:0;margin-top:0}.terminal-menu ul{display:flex;flex-direction:column;flex-grow:1;font-size:var(--global-font-size);list-style-type:none;margin-top:0;padding:0!important;width:100%}.terminal-menu li{display:flex;margin:0 0 .5em;padding:0}ol.terminal-toc li{border-bottom:1px dotted var(--secondary-color);margin-bottom:15px;padding:0}.terminal-menu li:last-child{margin-bottom:0}ol.terminal-toc li a{background:var(--background-color);margin:4px 4px 4px 0;padding-right:4px;position:relative;text-align:left;top:6px}.terminal-menu li a:not(.btn){border:none;color:var(--secondary-color);display:block;text-decoration:none;width:100%}.terminal-menu li a.active{color:var(--font-color)}.terminal-menu li a:hover{background:0 0;color:inherit}ol.terminal-toc li:before{background:var(--background-color);bottom:-8px;content:counters(item,".") ". ";counter-increment:item;padding:4px 0 4px 4px;position:absolute;right:0}ol.terminal-toc li a:hover{background:var(--primary-color);color:var(--invert-font-color)}hr{border:0;border-bottom:1px dashed var(--secondary-color);margin:calc(var(--global-space)*4) 0;overflow:hidden;position:relative}p{color:var(--global-font-color);margin:0 0 var(--global-line-height)}.container{max-width:var(--page-width)}.container,.container-fluid{margin:0 auto;padding:0 calc(var(--global-space)*2)}img{width:100%}.progress-bar{background-color:var(--progress-bar-background);height:8px;margin:12px 0}.progress-bar.progress-bar-show-percent{margin-top:38px}.progress-bar-filled{background-color:var(--progress-bar-fill);height:100%;position:relative;transition:width .3s ease;width:0}.progress-bar-filled:before{border:6px solid transparent;border-top:6px solid var(--progress-bar-fill);content:"";position:absolute;right:-6px;top:-12px}.progress-bar-filled:after{border:6px solid transparent;color:var(--progress-bar-fill);content:attr(data-filled);display:block;font-size:12px;position:absolute;right:0;top:-38px;-webkit-transform:translateX(50%);transform:translateX(50%);white-space:nowrap}.progress-bar-no-arrow>.progress-bar-filled:after,.progress-bar-no-arrow>.progress-bar-filled:before{content:"";display:none;opacity:0;visibility:hidden}table{border-collapse:collapse;color:var(--font-color);font-size:var(--global-font-size);margin:var(--global-line-height) 0;width:100%}table td,table th{border:1px solid var(--font-color);font-size:1em;line-height:var(--global-line-height);padding:calc(var(--global-space)/2);vertical-align:top}table thead th{font-size:1em}table tfoot tr th{font-weight:500}table caption{font-size:1em;margin:0 0 1em}table tbody td:first-child{color:var(--secondary-color);font-weight:700}.form{width:100%}fieldset{border:1px solid var(--font-color);padding:1em}label{color:var(--font-color);font-size:1em}input[type=email],input[type=number],input[type=password],input[type=search],input[type=text]{-webkit-appearance:none;border:1px var(--input-style) var(--font-color);border-radius:0;font-family:var(--font-stack);font-size:1em;padding:.7em .5em;width:100%}input[type=email]:active,input[type=email]:focus,input[type=number]:active,input[type=number]:focus,input[type=password]:active,input[type=password]:focus,input[type=search]:active,input[type=search]:focus,input[type=text]:active,input[type=text]:focus{-webkit-appearance:none;border:1px solid var(--font-color);outline:0}input[type=email]:not(:placeholder-shown):invalid,input[type=number]:not(:placeholder-shown):invalid,input[type=password]:not(:placeholder-shown):invalid,input[type=search]:not(:placeholder-shown):invalid,input[type=text]:not(:placeholder-shown):invalid{border-color:var(--error-color)}input,textarea{background-color:var(--background-color);color:var(--font-color)}input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:var(--secondary-color)!important;opacity:1}input::placeholder,textarea::placeholder{color:var(--secondary-color)!important;opacity:1}textarea{-webkit-appearance:none;border:1px var(--input-style) var(--font-color);border-radius:0;font-family:var(--font-stack);font-size:1em;height:auto;padding:.5em;resize:none;width:100%}textarea:focus{-webkit-appearance:none;border:1px solid var(--font-color);outline:0}textarea:not(:placeholder-shown):invalid{border-color:var(--error-color)}input:-webkit-autofill,input:-webkit-autofill:focus textarea:-webkit-autofill,input:-webkit-autofill:hover,select:-webkit-autofill,select:-webkit-autofill:focus,select:-webkit-autofill:hover,textarea:-webkit-autofill:hover textarea:-webkit-autofill:focus{-webkit-text-fill-color:var(--font-color);border:1px solid var(--font-color);box-shadow:0 0 0 1000px var(--invert-font-color) inset;-webkit-box-shadow:0 0 0 1000px var(--invert-font-color) inset;-webkit-transition:background-color 5000s ease-in-out 0s;transition:background-color 5000s ease-in-out 0s}.form-group{margin-bottom:var(--global-line-height);overflow:auto}.btn{align-items:center;border-style:solid;border-width:1px;cursor:pointer;display:inline-flex;font-family:inherit;font-size:1em;justify-content:center;outline:0;padding:.65em 2em;position:relative;-webkit-user-select:none;user-select:none;z-index:1}.btn:active{box-shadow:none}.btn.btn-ghost{background-color:transparent;border-color:var(--font-color);color:var(--font-color)}.btn.btn-ghost:focus,.btn.btn-ghost:hover{border-color:var(--tertiary-color);color:var(--tertiary-color);z-index:2}.btn.btn-ghost:hover{background-color:transparent}.btn-block{display:flex;width:100%}.btn-default{background-color:var(--font-color);border-color:var(--invert-font-color);color:var(--invert-font-color)}.btn-default:focus:not(.btn-ghost),.btn-default:hover{background-color:var(--secondary-color);color:var(--invert-font-color)}.btn-default.btn-ghost:focus,.btn-default.btn-ghost:hover{border-color:var(--secondary-color);color:var(--secondary-color);z-index:2}.btn-error{background-color:var(--error-color);border:1px solid var(--error-color);color:var(--invert-font-color)}.btn-error:focus:not(.btn-ghost),.btn-error:hover{background-color:var(--error-color);border-color:var(--error-color)}.btn-error.btn-ghost,.btn-error.btn-ghost:focus,.btn-error.btn-ghost:hover{border-color:var(--error-color);color:var(--error-color)}.btn-error.btn-ghost:focus,.btn-error.btn-ghost:hover{z-index:2}.btn-primary{background-color:var(--primary-color);border:1px solid var(--primary-color);color:var(--invert-font-color)}.btn-primary:focus:not(.btn-ghost),.btn-primary:hover{background-color:var(--primary-color);border-color:var(--primary-color)}.btn-primary.btn-ghost,.btn-primary.btn-ghost:focus,.btn-primary.btn-ghost:hover{border-color:var(--primary-color);color:var(--primary-color)}.btn-primary.btn-ghost:focus,.btn-primary.btn-ghost:hover{z-index:2}.btn-small{font-size:.9em!important;padding:.5em 1.3em!important}.btn-group{overflow:auto}.btn-group .btn{float:left}.btn-group .btn-ghost:not(:first-child){margin-left:-1px}.terminal-card{border:1px solid var(--secondary-color)}.terminal-card>header{background-color:var(--secondary-color);color:var(--invert-font-color);padding:.5em 0;text-align:center}.terminal-card>div:first-of-type{padding:var(--global-space)}.terminal-timeline{padding-left:70px;position:relative}.terminal-timeline:before{background:var(--secondary-color);content:" ";display:inline-block;height:100%;left:35px;position:absolute;width:2px;z-index:400}.terminal-timeline .terminal-card{margin-bottom:25px}.terminal-timeline .terminal-card:before{background:var(--invert-font-color);border:2px solid var(--secondary-color);content:" ";display:inline-block;height:15px;left:26px;margin-top:25px;position:absolute;width:15px;z-index:400}.terminal-alert{border:1px solid var(--font-color);color:var(--font-color);margin-bottom:var(--global-space);padding:1em}.terminal-alert-error{border-color:var(--error-color);color:var(--error-color)}.terminal-alert-primary{border-color:var(--primary-color);color:var(--primary-color)}@media screen and (max-width:960px){label{display:block;width:100%}pre::-webkit-scrollbar{height:3px}}@media screen and (max-width:480px){form{width:100%}}@media only screen and (min-width:30em){.terminal-menu ul,.terminal-nav{align-items:center;flex-direction:row}.terminal-menu ul{justify-content:flex-end;justify-items:flex-end;margin-top:calc(var(--global-space)*2)}.terminal-menu li{margin:0 2em 0 0}.terminal-menu li:last-child{margin-right:0}}.terminal-media:not(:last-child){margin-bottom:1.25rem}.terminal-media-left{padding-right:var(--global-space)}.terminal-media-left,.terminal-media-right{display:table-cell;vertical-align:top}.terminal-media-right{padding-left:var(--global-space)}.terminal-media-body{display:table-cell;vertical-align:top}.terminal-media-heading{font-size:1em;font-weight:700}.terminal-media-content{margin-top:.3rem}.terminal-placeholder{background-color:var(--secondary-color);border:1px solid var(--secondary-color);color:var(--font-color);font-size:1rem;text-align:center}figure>img{padding:0}.terminal-avatarholder{height:calc(var(--global-space)*5);width:calc(var(--global-space)*5)}.terminal-avatarholder img{padding:0}figure{margin:0}figure>figcaption{color:var(--secondary-color);text-align:center}.hljs{background:var(--block-background-color);color:var(--font-color);display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-quote{color:var(--secondary-color)}.hljs-variable{color:var(--font-color)}.hljs-built_in,.hljs-keyword,.hljs-name,.hljs-selector-tag,.hljs-tag{color:var(--primary-color)}.hljs-addition,.hljs-attribute,.hljs-literal,.hljs-section,.hljs-string,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type{color:var(--secondary-color)}.hljs-deletion,.hljs-meta,.hljs-selector-attr,.hljs-selector-pseudo{color:var(--primary-color)}.hljs-doctag{color:var(--secondary-color)}.hljs-attr,.hljs-bullet,.hljs-link,.hljs-symbol{color:var(--primary-color)}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><title data-gatsby-head="true">What was CVE 2020–0601 aka. Curveball? | Gatsby Starter Blog</title><style data-styled="" data-styled-version="5.3.6">.crIFBs{border-radius :5px;background-color:var(--header-font-color);display:inline-block;margin-right:6px;}/*!sc*/
data-styled.g7[id="Tag__StyledWrapper-sc-1wufizg-0"]{content:"crIFBs,"}/*!sc*/
.cjpKMj{font-size:14px;text-align:center;margin:2px 10px 2px;}/*!sc*/
data-styled.g8[id="Tag__Text-sc-1wufizg-1"]{content:"cjpKMj,"}/*!sc*/
.dnVzXH{margin-bottom:10px;}/*!sc*/
data-styled.g9[id="tagSection__StyledWrapper-sc-1aa460q-0"]{content:"dnVzXH,"}/*!sc*/
:root{--global-font-size:20px;--global-line-height:1.4em;--global-space:10px;--font-stack:Ubuntu Mono,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--mono-font-stack:Ubuntu Mono,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New,monospace,serif;--background-color:#222225;--page-width:60em;--font-color:#e8e9ed;--font-dark-color:#151515;--header-font-color:#7a3496;--color-gray-700:#BFDBF7;--color-tertiary:#ffdf2c;--invert-font-color:#222225;--secondary-color:#1F7A8C;--tertiary-color:#a3abba;--primary-color:#62c4ff;--error-color:#A31621;--info-color:#62c4ff;--dark-info-color:#0DA2FB;--warning-color:#c7b02c;--dark-warning-color:#766400;--danger-color:#A31621;--dark-danger-color:#580006;--progress-bar-background:#3f3f44;--progress-bar-fill:#62c4ff;--code-bg-color:#3f3f44;--input-style:solid;--display-h1-decoration:none;--spacing-4:4rem;--spacing-0:0;--spacing-16:4rem;}/*!sc*/
body{background-color:var(--background-color);color:var(--font-color);}/*!sc*/
ol li::before{list-style-type:none;margin:0;padding:0;}/*!sc*/
.no-line::after{content:none;}/*!sc*/
code::after,code::before{content:none;}/*!sc*/
.mermaid{margin-top:4em;margin-bottom:4em;}/*!sc*/
.bio-avatar{margin-right:var(--spacing-4);margin-bottom:var(--spacing-0);min-width:50px;border-radius:100%;}/*!sc*/
.bio{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:var(--spacing-16);}/*!sc*/
.bio p{margin-top:0.8em;margin-bottom:var(--spacing-0);}/*!sc*/
h1{display:block;margin-top:150px;font-size:46px;margin-bottom:5px;}/*!sc*/
h2{margin-top:150px;margin-bottom:15px;font-size:36px;}/*!sc*/
h3{margin-bottom:2px;color:var(--dark-warning-color);font-size:26px;}/*!sc*/
h4{margin-bottom:2px;}/*!sc*/
p span{margin-top:30px !important;margin-bottom:30px !important;}/*!sc*/
ol li::before{display:inline;}/*!sc*/
data-styled.g12[id="sc-global-kRUHyZ1"]{content:"sc-global-kRUHyZ1,"}/*!sc*/
.gHswLm{font-size:14px;padding-bottom:10px;}/*!sc*/
data-styled.g13[id="footer__FooterText-sc-ora8l1-0"]{content:"gHswLm,"}/*!sc*/
.kLqMAm{margin:0 auto;max-width:70rem;background-color:var(--background-color);color:var(--font-color);}/*!sc*/
data-styled.g14[id="layout__Wrapper-sc-omnq36-0"]{content:"kLqMAm,"}/*!sc*/
.jJcppV{font-size:18px;}/*!sc*/
data-styled.g15[id="styles__LinkText-sc-ncn1p3-0"]{content:"jJcppV,"}/*!sc*/
.bqQJTT{font-size:18px;color:var(--color-gray-700);}/*!sc*/
data-styled.g16[id="styles__DateText-sc-ncn1p3-1"]{content:"bqQJTT,"}/*!sc*/
</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" title="Gatsby Starter Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=a93fb0266df267ec6acb2d350ad1fe0f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a93fb0266df267ec6acb2d350ad1fe0f"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="true"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout__Wrapper-sc-omnq36-0 kLqMAm"><header class="terminal-nav"><div class="terminal-logo"><div class="logo terminal-prompt"><a class="menu-item" href="/">/home/toerktumlare/</a></div></div><nav class="terminal-menu"><ul><li><a class="menu-item" href="/">/home</a></li><li><a class="menu-item" href="/about">/about</a></li></ul></nav></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header style="margin-bottom:30px"><h1 itemProp="headline">What was CVE 2020–0601 aka. Curveball?</h1><h3 class="styles__DateText-sc-ncn1p3-1 bqQJTT">January 30, 2020</h3><div class="tagSection__StyledWrapper-sc-1aa460q-0 dnVzXH"><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->security</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->certificates</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->cve</p></div></div></header><section itemProp="articleBody"><p>Monday the 13th of January Brian Krebs published on his blog that he had sources telling him that the day after, Microsoft would release software updates that would fix a vulnerability in the Windows Crypto API.</p>
<p>And indeed, the day after on the 14th of January, NSA released a cybersecurity advisory that disclosed a vulnerability in the crypto API. This vulnerability allowed an attacker to defeat the certificate validation in Windows 10 and it would affect TLS, code signing etc.</p>
<p>Less than 24 hours later, security researcher Salim Rashid published a proof of concept on his twitter account showing that he successfully “rick rolled” github.com and nsa.gov using a custom-made CA certificate.</p>
<blockquote class="twitter-tweet" data-theme="dark"><p lang="und" dir="ltr">CVE-2020-0601 <a href="https://t.co/8tJsJqvnHj">pic.twitter.com/8tJsJqvnHj</a></p>— ✨saleem✨ ⍼ (@saleemrash1d) <a href="https://twitter.com/saleemrash1d/status/1217495681230954506?ref_src=twsrc%5Etfw">January 15, 2020</a></blockquote>
<!-- --> <!-- -->
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Shortly after this, Ollypwn aka. Oliver Lyak, a security researcher from Denmark, published a proof of concept exploit on GitHub for anyone to use. And what struck the world was that the exploit consisted of less than 10 rows of code and anyone could do it.</p>
<p>For the rest of this blog post I’m going to try to explain how this vulnerability works on a very high level, and point out why this exploit is extremely powerful.</p>
<h2>CA Certificates</h2>
<p>Let’s start by looking at what a basic CA Certificate consists of. These types of certificates are used to sign other certificates, as a form of trust. You have a certificate and you let a well-known certificate authority (CA) sign your certificate. By signing, they sort of “vouch” that you are who you claim to be.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/56ffd11d3c490037a2e4fde6ae7ecd48/37523/cert-example.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50.632911392405056%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABbUlEQVQoz32SPWvCQBiA/TtCRZohJEOge3cHJ5dOzhU6OTu23Tq5dpGMKQQc2i2D4CBaGrzEnOTM3cWk5ktIrphDo6X0GY7jvXt4P+5qrKQoCnbkfP8/tdNtSqlhGJvN5txPkiQMwyRJvkvSNL2Q8zxnjI3HY0VRRFGUJGk0GjHGeBwhNJvNIISmaVqWhRCK4zjLsipzEASKorTbbV3Xu92uIAi2teTHhBCnZL1e+75vl3ieV8mTyaRer/f7/eFwOBgMrq4a2pvOkwdBQAiBEG63W7cEY0wIqWSMsSzLrVar1+t1Oh3hujl9f2bpFy/bsqzVaoUQchzHLJnP51EUHWQ+G1VVZVluNhuidPPydB8at/70gRUZoT43uex5Hu9/t9tdTBuApaZpi8U8/Xykxl0EXnlRtm1jjF3XBQAQQnzfJ4TwmdWqty0O492jj3ip8hhjjLdKKYUQAgAwxr/f+eTneVHke64d1z84/YIfBeEM8hiDlAQAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Certificate example"
        title="Certificate example"
        src="/static/56ffd11d3c490037a2e4fde6ae7ecd48/f058b/cert-example.png"
        srcset="/static/56ffd11d3c490037a2e4fde6ae7ecd48/c26ae/cert-example.png 158w,
/static/56ffd11d3c490037a2e4fde6ae7ecd48/6bdcf/cert-example.png 315w,
/static/56ffd11d3c490037a2e4fde6ae7ecd48/f058b/cert-example.png 630w,
/static/56ffd11d3c490037a2e4fde6ae7ecd48/37523/cert-example.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>A typical CA certificate contains information such as the subject (who issued it), for how long it is valid, a key usage (what the key is used for), a public key and a declaration of what type of algorithm that is used in the CA certificate.</p>
<p>Two of the most common types of algorithms used are Elliptic Curve and RSA. <strong>It’s important to know that CVE 2020–0601 aka. Curveball only affects Elliptic Curve certificates. RSA type CA certificates are unaffected.</strong></p>
<p>Elliptic curve is a mathematical concept used in cryptology. <a href="https://www.secg.org/SEC2-Ver-1.0.pdf">There are many different types of mathematical curves</a> that can be used when using Elliptic curve cryptography so each elliptic curve certificate must include what type of curve that was used in the specified certificate.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/e6e7a66e5f6e5a550408fc237fb2b382/07d7d/example-curves.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 87.9746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAACQUlEQVQ4y3WTe3OqMBTE+/0/2Z22WrW2PkhyTggQ5RWlkvAIcAdi1c7t3Rn+/M1udg9Pl8slCAIxiTF2PB6jKBJCBJPiOP76+hr+UVVVwzA8aa2llPv9HgB2ux0ico6EUgZIKOOcHw6Hpmnatu2+1ff9FbbWFkUhpZywUR4hApj/+cHX73EYxEmaZZnWuus6a63jtdYj7DLkeS6lpJMYIt9u8GMtCWmLczcMztZOcs51XV+dT6dTGIacc0T0OaeMhYh89gwvf6QQxzhOkqQsy0dnY8zVua5rx1NKCSGEMtxu2Md7sN/1unQNPTrfY3dd50jf9wGAI1LGAgRcLWAxP4ZhnCRZmj6++V7YMAxa6zRNwzBkjAEAQxTEw/UK35dlluqqMlo3TfPf2HmeR1E0xfYoAO42bPMZUO87dt/3/SPsxh8LO5/PURRxzhljiEgIFcD46o3OXw9BECdJOsXu+/6XqYwxSqkoihARAAC58Ha4XorPdX1SjbVt0zjsBl8ul2thztn3fUopABBKfULY2wyX81RGuVJ5nhtjfok9DENZlmmaBkEwwoxNsAeLOXubXfJsLMyYuq5va1lrr843WErJJlEAQTxYr8R2Y06qapqqqh6PzFp7dXYZbg8eC6NUMIrLuff6HIdBkmaPsX/A7raVUvfbBvD3O7ZajIWdT421TVPfCvsBW2uVUmEYIqIrbO8RQQnMXtjs+SD8eFzqPpVTURRX57ZtjTFFUWRZlo9fro6HdL9VQPu6ut32o9xf9Rcyye585QrAZwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Example curves defined in the “Standards For Efficient Cryptography”"
        title="Example curves defined in the “Standards For Efficient Cryptography”"
        src="/static/e6e7a66e5f6e5a550408fc237fb2b382/f058b/example-curves.png"
        srcset="/static/e6e7a66e5f6e5a550408fc237fb2b382/c26ae/example-curves.png 158w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/6bdcf/example-curves.png 315w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/f058b/example-curves.png 630w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/40601/example-curves.png 945w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/78612/example-curves.png 1260w,
/static/e6e7a66e5f6e5a550408fc237fb2b382/07d7d/example-curves.png 1478w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>Each curve is made up a series of parameters called p, a, b, G etc. and by declaring that we want a predefined curve like secp256r1, these values (p, a, b, G) will be set for us automatically, and our certificate will use that specified curve.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100.63291139240506%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAESklEQVQ4y4VV208cVRz+zVKpcr8vLFYEloWdMwMKiSG10tQuy54DmGJpcaUVand3ZvZy5rLLNSlpWq2JRpOWl7ahNUaJ9QXZPUMpFaOJD9r4om8++9o/AjOX3dLE6Em+ZHLmzDe/75zv9x2A/xiyqnOSqoOk6p0S1dokqoEFAReAJybwhHE8YYAwa0WEtSDCnicQcQFEnIf+yDYgYkJU+phLGQYkjZxPonq9rBqQoLrzHltEBQtlCDNRwHnOmrOHP3LTXeAgSHYAkR3wvvUEUkYOZG3ZK1GjWlazEM9k7Z/xxOScKs0AT1iT++wQHiZDrhxEdioGJrerYuoKXL06V5/U1Jr1T0Mwp6wCIoxD9hrmRYT1WLKLP3AII3mbjLerMz0Is16BmAFxnPX0hPf84dnbQx8kV2tPnr8PvpEn4JDtVCNiisF39p99b+3h0NjWof2wq0QIF5qsj/yjPwLAATc6e0ccntocDoT3fAMT+RedAzBFkbAywToU8kwhtJ/5xT41l7AFYdZhvySm53T0nueCcg3W1i41xNO52u7QfrNIWB8i7NU+vM2hIpkLeyg0DSemv/IE8UMQCOsVxwsVPeF9wLProOg5Lp3NgqwttSqaWnNqZsOuui+yCxB8CiPn7sM366J9UJadEhkVIK0rMKesWNIgGNntgpoDbib2EaT1FCQyFBQ9C6nsQnOCGlXGQgIO/gC4+/kwpPU0SFQHWdVslAhjaeOonovVnY7ebXhj6jvh0UbTkfnkcoVMtZdkVa9IpOkLST3bIVHdK1O13J7/F0hUa0xk1DKIZ/T6lJYKno/dCISid0YWl+bb4plch6zqr9igmk/RjEFZ1XlZ1dpL88/jmEQ1IZ5Rj0JSS8F8chkODgACoz90Pt5sgvnkCiQ1astQNMOS3JigRkVSUyG7GAM9J4FiS9VLsNbGLckSpUAu3vR0hn6GflLoG5zcqix77W+4KF/hFM3gUtkFUPTF1svphbrR929D1dBf0PLm7zCXXOVm4te5jJGy9pKTqMbFMxTA++5vtm0c6zAvwuyYYwPTE4pueJZWZVhcUZqurU1X1A7/WT5AtptFXGjgsQm8613esZljm8HIlt1qXZOm2wGmyBOz0nruDu3DxNwtOHPpi+7jZ78e6h3bDYiEtQuYdSLM+MDY9xxfJMTMLsrt5WIc7QA//rCcJ6aACPOL4wV/ILznP/XeveP4wi2f5cNA+LGzHhcaecIEHuehHW8Cwiag8WIvO81dIhUj21w/zle/PrFVDb1Pj1xZ+7BhaXm+8pPrU3Dy3JdWTHFuN/kQYV1uUHClbmme/smpziUVI3k7G1tP/ApnL38GkrbcGs9ka2TNyUPeCQMncTALIsJqS71cHMNvP7ArDbrE/TgP0cQNjuZUK2DbJKrXFQNWwA8OR145wkwQyCPoHfsW4P+uANdnfolq7cUroJhMAi5wrkNeFjGrt1T9AziN0F6XhB1LAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="example curve"
        title="example curve"
        src="/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png"
        srcset="/static/ba395866b6facbfd04e1490275a99d60/c26ae/curve.png 158w,
/static/ba395866b6facbfd04e1490275a99d60/6bdcf/curve.png 315w,
/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png 400w"
        sizes="(max-width: 400px) 100vw, 400px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>Sometimes you want to use a custom curve or a “not yet implemented” curve and to do so you can include all the needed parameters in the CA Certificate directly instead of defining a predefined curve.</p>
<pre class="prism-code language-shell" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token plain">Curve: parameters p/a/b/G</span></div></pre>
<p>When Microsoft implemented the functionality, that you can supply your own parameters to represent an elliptic curve, that’s when the vulnerability CVE 2020–0601 got introduced into Windows 10.</p>
<h2>Certificate Usages</h2>
<p>Before we can investigate how to exploit CVE 2020–0601, we need to first talk a little about how certificates are used in the real world. We are going to look at one way of using certificates to enforce trust, and that is when requesting websites.</p>
<p>Windows 10 provides a library applications can use to verify certificates. This library is called crypt32.dll and it is here the vulnerability was discovered. Any windows application — such as web browsers, file transfer tools or email clients — that rely on this library, to verify cryptographic signatures, may be affected by CVE 2020–0601.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f84145a9243c23753f3ee3f081b79109/37523/yt1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABCUlEQVQY05WQvUrEUBBG97l8A1/A0lbEIIKFsIXVguAWusUaItYrCCI2gqAL2yxICkmpLhKNYmCTu+bn5uZO7sxoNKCFoJ5qmvPNzNfiD4gZkIj/R2taGPs67Yxf14cCzJf+PQhnAu/vdJZWiKA1ADTyrYCF0+nSebQ2FJkslCq0rvJMhI+uUmWpVIEUb23K+bnxzvbB4HDfth3H8TyvlkNpuldJeyRWL+MSDCEiEhowkNWjMcgMkxsYXcjw5SEInoLAdV3f92v580JVkVCIPz5NlHXayfKifvbTQsVRtGJZe/1+I/8GqeOjpGvJyUlpWOZ5r7d7NthgVq0/FkusiZueyGiuZu+b3wDDV4K694c+3AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="handshake example"
        title="handshake example"
        src="/static/f84145a9243c23753f3ee3f081b79109/f058b/yt1.png"
        srcset="/static/f84145a9243c23753f3ee3f081b79109/c26ae/yt1.png 158w,
/static/f84145a9243c23753f3ee3f081b79109/6bdcf/yt1.png 315w,
/static/f84145a9243c23753f3ee3f081b79109/f058b/yt1.png 630w,
/static/f84145a9243c23753f3ee3f081b79109/37523/yt1.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>A majority of trusted sites on the internet have their own signed certificate. This is used to verify that, when we request something on the internet, we get it from the actual place we requested it from. It’s to prevent things like man-in-the-middle attacks, fake websites etc.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/bc7bdecc79a5adc7a42f6ace2f671b65/37523/yt2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.405063291139236%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAABGklEQVQY052Oy0rDQBSG80I+gY/gRhTcunIjLhW68RW6ryiIi4pQInbjBSxiSSBiFCwILWiKiNBcTjKdJpnLmRmJBV3YIvgtzuLA9/+/lTJ1FRSHPbr/RLWZA6KW8vfbehzxtXa4cRHvdjPBOWcMURP4SONAohZSFpRmO5tkffX61LbP2sfNpm3bAFDJAxDbnWTrMqzdgJSVzoXMx3E5GQmJQgpWlkW7xU+Ohv2+47qe5zmOQwipZKV1ynVQmgFRWs8dPhOrOpyZtxdDs6kaRdG9/4D4HaSNQqNQqx+mNZXMup1wcYHUaxFNcjppNPZWlpeee3eEUABI0xQAKKWzm/WYcPc29w8QM2PM6/D9vFVnif/Vqv6a/V8+ASOMvVHM2egZAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="sent cert"
        title="sent cert"
        src="/static/bc7bdecc79a5adc7a42f6ace2f671b65/f058b/yt2.png"
        srcset="/static/bc7bdecc79a5adc7a42f6ace2f671b65/c26ae/yt2.png 158w,
/static/bc7bdecc79a5adc7a42f6ace2f671b65/6bdcf/yt2.png 315w,
/static/bc7bdecc79a5adc7a42f6ace2f671b65/f058b/yt2.png 630w,
/static/bc7bdecc79a5adc7a42f6ace2f671b65/37523/yt2.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>Let’s say we would like to make a connection to youtube.com. As we request to connect to their website, they will first send over their own certificate (that is signed by some CA). Then they will also send over the root CA that signed their certificate (the certificate that vouches that they are who they claim to be).</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/3b0e6d20057c58b0584fe9cbe5d90486/37523/yt3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 44.93670886075949%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABUklEQVQoz42QPUvDUBSG85P0D+gfqcVJxEUXcSg4iLtDx+Igkg4WB60fKA7VQRAySG0Fo0PTpHhj89E0yb1J7jn3SowfBcH6TOcceDjvOYr8IkOBQkghPnuB8heICACIyDmXUipBgupjtKMFGy3PZblQ6GLCEQDovEEUCik55wBQzBUj4Asnw+ULZ+XSJQGlUchYQmlMDC2OxnklpX92NJqfMdaW9hqN3VqtWq2qqpplmUJiqNx4q1du+dQdUszjfqxOqYMIRcPt16R5mNxrL73eQ7vd6XS63S4AKEVCh/K2NXL8wCbEtm3DMMIwktPIZZowx3EET5OEEULMfj/LUkSYOFpIAIH5q77J5eS4QeZmw4N9P+MpY/V6vVQq60+6ZVm6rpum+dfmTLsLt9bH55shc4FD6/p2u7JInpueHw8GJiFkSmwpUYjoJ2DqScHkP3gHojDzaCBGi5EAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="check trust"
        title="check trust"
        src="/static/3b0e6d20057c58b0584fe9cbe5d90486/f058b/yt3.png"
        srcset="/static/3b0e6d20057c58b0584fe9cbe5d90486/c26ae/yt3.png 158w,
/static/3b0e6d20057c58b0584fe9cbe5d90486/6bdcf/yt3.png 315w,
/static/3b0e6d20057c58b0584fe9cbe5d90486/f058b/yt3.png 630w,
/static/3b0e6d20057c58b0584fe9cbe5d90486/37523/yt3.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>The browser will first verify the signature using the crypt32 library provided by Windows. Then the same library will check against an internal registry that contains many predefined trusted root CA’s, that the CA certificate youtube.com sent us is from someone whom Windows trusts.</p>
<p>If all verifications go well, a secure connection is established and for future requests, crypt32 in Windows will cache the sent root CA so that it can speed up subsequent requests.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/1e37ccf6419275189394543bc871656c/37523/yt4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.075949367088604%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA70lEQVQY05WPz2rCQBDGfa0+Qd/Cd0gvKfTgvaeSSyFe2lM9SCj0UKFQemkJCipCQdEqiiQpkVSyrrvZ3ZkpS9KePOjHdxiY7zd/avQnZVABnaQaEb0uxXWP1Ts/j7M9ERm0DQP4H0IpzOdILhdCFlIIxhgAVPDtIG88zW+ev96nG6W2vOBcsmTV5ftMyN2OdB6+bc/Pvq+c5t190/c9zwuCoII/5vkwnPZfwvFwQkSAYK05oLEFIQiuRwOM1mmWxXGcJEmaphUMSi/G0YXjupeu1qq89NifbRbgodVu+Q4V0WEY0fogXA4gw47cWcK/6OiI9iMIqXIAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="cache cert"
        title="cache cert"
        src="/static/1e37ccf6419275189394543bc871656c/f058b/yt4.png"
        srcset="/static/1e37ccf6419275189394543bc871656c/c26ae/yt4.png 158w,
/static/1e37ccf6419275189394543bc871656c/6bdcf/yt4.png 315w,
/static/1e37ccf6419275189394543bc871656c/f058b/yt4.png 630w,
/static/1e37ccf6419275189394543bc871656c/37523/yt4.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>It is here, after caching, that a vulnerability exists that lets an attacker produce a malicious CA certificate that in turn will be trusted by Windows.</p>
<h2>The Vulnerability</h2>
<p>If we investigate how crypt32 in Windows verifies CA certificates in its cache, it goes through all cached certificates and checks if the public key in the provided CA certificate matches any of the cached CA certificates public key.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/adb8baa49ea215d570fedddd24959dc4/30d16/compare-cert.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 81.64556962025317%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAACyUlEQVQoz3XSSW/TQBQAYH4Tv4QTy6kSF66V4MQRCXGAA4dKqCwSaiVahFBbUkpaJ03aOItdx3ZiN3EWu/bEdpLWnsRJHDuxx4OyqFCWp7nMm/dJb+bNLYxxGISGbupAn/gTFKKpH6AQ4XlEUYQxtmzLtE3H70+m3jScTMNJhGf5WxjjtnxVo5VGUS0QjMzrFyVDE82pHyw8dGG5W1pf+/Dq2euCQouXFd7gusPODIcBanLAOL/6urF79979jTfvDbFTo9QhdBdYtdUyLK+9WL9z+8Hzl0+qVzytnTWt5hyHSCnpLaGb2Ms8erhysrWqi6DOtIa9JW71ANfmcs3846ere5srUid3pvPKAiMU1RiFIlgx1wBkWT9lL1LiBSV3TVvVVKACDWpJIXFSyQhqXqqTgpjhKyeyLc9whKIq3cwfMtk4zR6XC/FiPV+XGTCwRyEKojACUCNKRJw5TPLJY5YgxRQLzm5g8oCiE1zhiCkQRS5TaRbB9Z1BD8TZOMESST5BcMSxkKZUWoFzjCNcpRXyoCglhPoBU01L1YJaozTX8RbYcPTv3I8TIcnyR5ScpQCdU/MKVJaj8gZu34SDNnQMu2/CnmH3OzCKlqOeBn4Htrq9VsfWjNkChqWOfXeBUfc8IWW2L852dW7f4GJW5RCbeTS2F3jUaMjfYlJsv51KBSw3YYs+RU00bYlh/bTFxACzD6tJX836ajZs5dDYnv8uDHk+9+5t+fO2c5p2s6Sby47SKa8mLdv+Xyz+5lCS6js7E4aZFpkxVXBpapQlfUVe4mheFYYhhD0Ie47jjH3f8/2e0+8PBo7jDC3L6V7apuk5feR5oetGQfALY4zH4zHDMFVJEnleEcRWpcplSJ7MsscpIMtmt1MWBGcwuK7/q+15dtruWFtfLj9+GhAp54CwNrc9qTE7RWhZ808c/RazLULRzfjjUX4CrPhT5nFeoH8AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="compare certificates"
        title="compare certificates"
        src="/static/adb8baa49ea215d570fedddd24959dc4/f058b/compare-cert.png"
        srcset="/static/adb8baa49ea215d570fedddd24959dc4/c26ae/compare-cert.png 158w,
/static/adb8baa49ea215d570fedddd24959dc4/6bdcf/compare-cert.png 315w,
/static/adb8baa49ea215d570fedddd24959dc4/f058b/compare-cert.png 630w,
/static/adb8baa49ea215d570fedddd24959dc4/30d16/compare-cert.png 672w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>What it on the other hand doesn’t do is verifying that both certificates are using the same type of curve. If we manage to guess the curve and the private key, we can successfully produce a fake CA certificate that we can use to sign other certificates and it is game over.</p>
<p>But before we can produce a fake CA certificate we need to know a bit more about Elliptic Curve cryptology.</p>
<h2>Elliptic Curve Basics</h2>
<p>So, what is Elliptic curve cryptography, or ECC for short? It a type of cryptology in a category called asymmetric cryptology. In asymmetric cryptology you have a Public Key and Private Key. The public key can be exposed publicly, and anyone can use it to encrypt things. But the private key is the only thing that can decrypt whatever was encrypted with that particular public key.</p>
<p>It’s very common that you share and store the public key widely across the Internet so that if someone needs to communicate encrypted with you, they can use your public key and then only you with the matching private key will be able to decrypt the message (Quite good right?).</p>
<p>Well we talked a bit before about a set of predefined elliptic curves that you can choose from when generating a CA certificate. These curves are built up by a set of predefined values called P, a, b etc. If we define these values in a specific formula, we get an elliptic curve.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 400px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100.63291139240506%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAESklEQVQ4y4VV208cVRz+zVKpcr8vLFYEloWdMwMKiSG10tQuy54DmGJpcaUVand3ZvZy5rLLNSlpWq2JRpOWl7ahNUaJ9QXZPUMpFaOJD9r4om8++9o/AjOX3dLE6Em+ZHLmzDe/75zv9x2A/xiyqnOSqoOk6p0S1dokqoEFAReAJybwhHE8YYAwa0WEtSDCnicQcQFEnIf+yDYgYkJU+phLGQYkjZxPonq9rBqQoLrzHltEBQtlCDNRwHnOmrOHP3LTXeAgSHYAkR3wvvUEUkYOZG3ZK1GjWlazEM9k7Z/xxOScKs0AT1iT++wQHiZDrhxEdioGJrerYuoKXL06V5/U1Jr1T0Mwp6wCIoxD9hrmRYT1WLKLP3AII3mbjLerMz0Is16BmAFxnPX0hPf84dnbQx8kV2tPnr8PvpEn4JDtVCNiisF39p99b+3h0NjWof2wq0QIF5qsj/yjPwLAATc6e0ccntocDoT3fAMT+RedAzBFkbAywToU8kwhtJ/5xT41l7AFYdZhvySm53T0nueCcg3W1i41xNO52u7QfrNIWB8i7NU+vM2hIpkLeyg0DSemv/IE8UMQCOsVxwsVPeF9wLProOg5Lp3NgqwttSqaWnNqZsOuui+yCxB8CiPn7sM366J9UJadEhkVIK0rMKesWNIgGNntgpoDbib2EaT1FCQyFBQ9C6nsQnOCGlXGQgIO/gC4+/kwpPU0SFQHWdVslAhjaeOonovVnY7ebXhj6jvh0UbTkfnkcoVMtZdkVa9IpOkLST3bIVHdK1O13J7/F0hUa0xk1DKIZ/T6lJYKno/dCISid0YWl+bb4plch6zqr9igmk/RjEFZ1XlZ1dpL88/jmEQ1IZ5Rj0JSS8F8chkODgACoz90Pt5sgvnkCiQ1astQNMOS3JigRkVSUyG7GAM9J4FiS9VLsNbGLckSpUAu3vR0hn6GflLoG5zcqix77W+4KF/hFM3gUtkFUPTF1svphbrR929D1dBf0PLm7zCXXOVm4te5jJGy9pKTqMbFMxTA++5vtm0c6zAvwuyYYwPTE4pueJZWZVhcUZqurU1X1A7/WT5AtptFXGjgsQm8613esZljm8HIlt1qXZOm2wGmyBOz0nruDu3DxNwtOHPpi+7jZ78e6h3bDYiEtQuYdSLM+MDY9xxfJMTMLsrt5WIc7QA//rCcJ6aACPOL4wV/ILznP/XeveP4wi2f5cNA+LGzHhcaecIEHuehHW8Cwiag8WIvO81dIhUj21w/zle/PrFVDb1Pj1xZ+7BhaXm+8pPrU3Dy3JdWTHFuN/kQYV1uUHClbmme/smpziUVI3k7G1tP/ApnL38GkrbcGs9ka2TNyUPeCQMncTALIsJqS71cHMNvP7ArDbrE/TgP0cQNjuZUK2DbJKrXFQNWwA8OR145wkwQyCPoHfsW4P+uANdnfolq7cUroJhMAi5wrkNeFjGrt1T9AziN0F6XhB1LAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="elliptic curve example"
        title="elliptic curve example"
        src="/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png"
        srcset="/static/ba395866b6facbfd04e1490275a99d60/c26ae/curve.png 158w,
/static/ba395866b6facbfd04e1490275a99d60/6bdcf/curve.png 315w,
/static/ba395866b6facbfd04e1490275a99d60/e17e5/curve.png 400w"
        sizes="(max-width: 400px) 100vw, 400px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>To start generating a public and private key from this curve we first need to define a starting point on the curve, we can call this starting point G (the generator). From this starting point we then start jumping around on the graph “n” number of times.</p>
<p>I’m not going to explain how we jump around on the curve because it’s quite complicated and there is an entire wiki page describing just this so we will leave that out for now. But what you should know is that by jumping around millions, or even billions of times on the curve will result in a series of dots (when you remove the curve) and this will end up as a very large factor. Let’s call this factor “x”. In the end we end up with a simple formula x * G (starting point multiplied by our factor).</p>
<p>This formula will be equal something so let’s add that to, so we end up with something like:</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/6556231d00d61215e279756f6bd5dd23/37523/maff1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABG0lEQVQoz4WRv6uDMBDH/f8HR5dOxbWlIKWldJOCIi4i0hJiobr4KxgwikiSK8+8F2wd3me63N0398uAGSkln5FSwh/KFkJwzgFgnWDACjmjZMvUNYYKj+N4OByOx6MqopSMMQDI89zzPAA4n8+Xy0Un/IiFEAAQBMHtdnNdN47jMAz3+70QwrIs3/cZYwihJElOp9Nut3s+n3qi38pFUdi2bZpm0zRRFF2vV875drv1fV8VIYQ4jrPZbD7E2iKElGWpGgGAvu8ppYwxKaVytjMfM+sltW1b17XeVlVVj8cjz3OlFEKo36dp+l5Y13UIIYwxpVQFiqLAGL9er2EY1PN+v6dpmmWZPoEB/7G8lh7qW6wbXj61Ry7Q4jeMLTdYNn7CgwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="curve equation"
        title="curve equation"
        src="/static/6556231d00d61215e279756f6bd5dd23/f058b/maff1.png"
        srcset="/static/6556231d00d61215e279756f6bd5dd23/c26ae/maff1.png 158w,
/static/6556231d00d61215e279756f6bd5dd23/6bdcf/maff1.png 315w,
/static/6556231d00d61215e279756f6bd5dd23/f058b/maff1.png 630w,
/static/6556231d00d61215e279756f6bd5dd23/37523/maff1.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>Where G is our starting point on the graph, x is the result of us jumping around, and the product is Q.</p>
<p>When defined, x in this formula is our private key and Q our public key. And as mentioned before our public key we can send to anyone, but how we got the result (x and G) is our “secret sauce” that no one can know anything about.</p>
<p>Trying to derive the key by flipping the formula is what is known as the Discrete Logarithm Problem and is known to be a very difficult problem so that is not a possibility when trying to reverse engineer the private key.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/8e266866b39ac710d2ebd6fa24063a37/37523/maff2.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 36.708860759493675%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABK0lEQVQY012QTU/CQBiE+bPGs+GqVyLeSAjBExEvoqUBSiURgdhIQ/1GpZiKSAWhtJFEo6Tt7r6vaWtqdU6zmzyzOxNDRHAdMhyQxRugJ4boGQhOnn4dIrNM8qIHPubDLhkOoN9zO22q3uF8hpQyAPnqWrnpAiJZLJZqz2w16snEpNVAcw5+dCzIcAkpCYKmabZpKnzROD4a5HPtdKqVTBil4j3PTS7ORY6rCEK92fS/FYERcS0elyVpetvd3lif1sThwd7h1mZmdWVc5s92csunx8pufr9QyGSzIeLDlHz1e3q1bNSq7EEFY+Z1Y+xSVU86ytK2Py0T9ZF1Ksnp1LMosOlrpLPjUH0Ejh3O82+wP/p4p5Nx5OWQAfAYxoIb6uunIWPAqLdjJOcbr+t7juqIZRAAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="discrete logarithmic problem"
        title="discrete logarithmic problem"
        src="/static/8e266866b39ac710d2ebd6fa24063a37/f058b/maff2.png"
        srcset="/static/8e266866b39ac710d2ebd6fa24063a37/c26ae/maff2.png 158w,
/static/8e266866b39ac710d2ebd6fa24063a37/6bdcf/maff2.png 315w,
/static/8e266866b39ac710d2ebd6fa24063a37/f058b/maff2.png 630w,
/static/8e266866b39ac710d2ebd6fa24063a37/37523/maff2.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>So, for the time being this feels pretty secure, right?</p>
<h2>CVE 2020–0601</h2>
<p>With this knowledge as a prerequisite this is where CVE 2020–0601 comes into play. Since Windows does not verify the curve provided in the certificates, we can provide these parameters and create a malicious certificate based on this simple math.</p>
<p>Since we can control the parameters, how about we set the private key to something like 20, or 100 or just something simple…. like the number 1?</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/da65fd3694e426caa381884c16026b00/37523/maff3.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 20.253164556962027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVQI1zWOwYqFIBhGe/+3CDetg0ubIChs2yIoiStUEGSUmYUapv8ME3NWHxw+OAFjrG1b7z0AWGuFENd17fs+z/MwDPAPIWRd13cvy/KqoCgKhNA4jmVZLsuSZZkQou/7PM+jKFJKAQDnHCGEMe66jhCCMQ7DUCkVUErjON62ra7r8zynabLWAkDTNGma3vcNAM/zJElSVRWl9PvH5/PRWgfGmOM4tNYAIKVkjCmlnHPbtkkpjTFvqlJKCOGc895zzqWUv+cf3N/XbjaIlsEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="breaking the maths"
        title="breaking the maths"
        src="/static/da65fd3694e426caa381884c16026b00/f058b/maff3.png"
        srcset="/static/da65fd3694e426caa381884c16026b00/c26ae/maff3.png 158w,
/static/da65fd3694e426caa381884c16026b00/6bdcf/maff3.png 315w,
/static/da65fd3694e426caa381884c16026b00/f058b/maff3.png 630w,
/static/da65fd3694e426caa381884c16026b00/37523/maff3.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>This will result in our public key being equal to our starting point on the graph, and just like that we have the two secrets parameters, just from knowing the public key!</p>
<p>With all this information we can now forge any Elliptic Curve certificate just by acquiring the public key. Here’s an example. We acquire a public key say 1234 and we put this into our formula:</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/12c29d0d2048c2dcdeee4639af6b980e/37523/maff4.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 30.37974683544304%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA7ElEQVQY04WQsYqFMBRE3/9XfoIIai0INmJSiFpYWYhVwEIMEo0aiTGJ+nCzWC3slHfmwJ353H/p+tH9nz5KKcYYpRRjvG0b51wpZTzGmNaaUiqE4JzP8zwMwziOx3EIIR54HMcwDOM4dhzH933LsggheZ4TQgAAXdfVdb2uKwAgiiLP82zbdl03TdMHllI2TQMhLMsSABAEwTRNWZb1fY8xnufZfNG2LYSwKAoAQJIkVVU9sPGWZUEIUUpN4fu+hRB93w/DcJ6nyazrihDquu69/MJaayGElNIY13Vprfd9N93ezL7vx3G8o3wBYfZK/RCGiVsAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="breaking the maths"
        title="breaking the maths"
        src="/static/12c29d0d2048c2dcdeee4639af6b980e/f058b/maff4.png"
        srcset="/static/12c29d0d2048c2dcdeee4639af6b980e/c26ae/maff4.png 158w,
/static/12c29d0d2048c2dcdeee4639af6b980e/6bdcf/maff4.png 315w,
/static/12c29d0d2048c2dcdeee4639af6b980e/f058b/maff4.png 630w,
/static/12c29d0d2048c2dcdeee4639af6b980e/37523/maff4.png 720w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<p>And by using this information, we can then generate a valid CA certificate that we control!</p>
<p>So to recap:</p>
<p>Just by acquiring the public key from any source we can then generate a fully valid malicious CA certificate that we can use to sign any other certificate. This certificate will then be trusted by Windows 10 because it will pass the check against it’s certificate cache.</p>
<h2>Ollypwn’s Proof Of Concept</h2>
<p>Oliver Lyak demonstrates this in a Github repository how to exploit the vulnerability by generating a false CA certificate and then proceeds to demonstrate how it can be used to sign other certificates, or sign code as “trusted”.</p>
<p>The code below is taken from his example.</p>
<pre class="prism-code language-ruby" style="color:#F8F8F2;background-color:#282A36"><div class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">require</span><span class="token plain"> ‘openssl’</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Read file provided in the first argument</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">raw </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">File</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">read </span><span class="token constant" style="color:rgb(189, 147, 249)">ARGV</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Parse the file as a certificate</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ca </span><span class="token operator">=</span><span class="token plain"> OpenSSL</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token constant" style="color:rgb(189, 147, 249)">X509</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token class-name">Certificate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">raw</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Extract the public keyca_key = ca.public_key# Set a private key to 1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ca_key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">private_key </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Get the group parameters that contains the curve</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">group </span><span class="token operator">=</span><span class="token plain"> ca_key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">group</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set the generator parameters (G in our formula) to the public key</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ca_key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">public_key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">order</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">cofactor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Ensure we are sending explicit parameters and not a predefined curve</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">group</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">asn1_flag </span><span class="token operator">=</span><span class="token plain"> OpenSSL</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">PKey</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token constant" style="color:rgb(189, 147, 249)">EC</span><span class="token double-colon punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token constant" style="color:rgb(189, 147, 249)">EXPLICIT_CURVE</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set our new group with our fake generator G’ = Q</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain">ca_key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">group </span><span class="token operator">=</span><span class="token plain"> group</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Save this to a file as our new CA</span><span class="token plain"></span></div><div class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin" style="color:rgb(189, 147, 249)">File</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">“spoofed_ca</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">key”</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ‘w’</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">f</span><span class="token operator">|</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">write ca_key</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">to_pem </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span></div></pre>
<p>It first reads in a predefined CA certificate, for example the MicrosoftECCProductRootCertificateAuthority.cer which is the official certificate Microsoft uses to sign many things with.</p>
<p>Then it reads out the public key from it and then defines at sets some new custom parameters, generator etc. We can see that the code explicitly sets the private key to 1 and then save it to a new spoofed CA certificate that can be used to sign code or other certificates.</p>
<p>This newly generated certificate can be used to act like microsoft and sign other certificates. We essentially can claim that we are Microsoft and vouch for anyone. Extremely powerful.</p>
<p>Ollypwn then continues to demonstrate how to sign some code as “trusted by Microsoft” and also how to generate a website certificate claiming to be issued by www.google.com and then sign this certificate with the crafted “Microsoft” certificate.</p>
<p>What this all boils down to is that by exploiting CVE 2020–0601 we can claim that we are anyone, and we can vouch for anyone on the internet.</p>
<p>This in turn can be used to pass firewalls, push fake updates containing malware to any Windows 10 machine claiming we are “Microsoft”. We can for example set up fake websites claiming that we are any of the big companies and we can also develop malicious programs that windows 10 just blindly will trust as “safe software”.</p>
<p>The possibilities are endless, only creativity will stop you and the hackers out there.</p>
<p><div><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 438px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/42fc74204812244be63f4b6dcd477123/50e4b/summary.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 72.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC1UlEQVQoz6WTXUxSYRjHvei+i+7qoptq68L8qFGDJepamiH4sVBpNnRM5so0W+YQS6ZzJKSt8qsPy+a3nkMgR7EwDUshKsSAzNDCUkTDw5dKk3Pedg7m1K2r/nsv3r3b73me7f09IeAfwXEcI7N5CSYQCAQfAQAh4D+yDcYBwHCwjhFVbTab+qUaQRCz2azRaORyuUqlMhgMEAQplYj1q5WAMZwAyCk2gmEYAMBisQy9ftWLKMxm8/DwcFdXd39fv17//nHTo26o02QybeuMA4CuYVZ0ffTn6ot50KsakxbW2Wd+2b7bILinrr62o6NtZmba7Vi5L2yWd/QRsOaHv97gKR1Bn5l8WX1LDMhBb52Pk7laBrSU3akn9rCoFFpaApeXUsBh8E5So6l7GUd2sbo7ZQR8We2ktdij2+1VOlcSvBjf5WD0LJyFUfOCm8c+c2hfhCCzWpL15Da3Wcp9WsFriDhApYTTl9FlAi4dQRMhBwt23P3gzuhdSoIdTNjJk5tm9bmfumgKSUbRaXF5Yr2Y/aAypVGYUMMOy2Mncci/BCFNE16hBi1741JYV2v0boluWaxfR8ba13THSrj0oXrmdTaTEZbVmNd+ISY3MTSdH1oWE8p0ecnOQg3K6HGwILKzYikZtsdCfniw0jsS6dTFerQMaXbJwf1hnWIk/PDRK8xSQdS9hMh0tw8l4PxBJ63VHtVmv6V1JcEL9G5fheL5IhKDjl+dRDgNXL4gtbq8QKJu0kmLa0XZ0txw0bWcm8TYGB4yOud/aPSK3qLtFk/2gE8gU07K4gRtHVYPcNjn0iiFuceFOefy+JkX+ZxLBafKzkfkG40TQR22GIZjngDwflPaptR9s8C54gcAWKemRdw7RfFVxcliQaL0RnrNR52RJPENwwLk2SoZqQwI2u//7f9stGpV46Z3X3w+36aCO90mPcVwHCNq/VUVx/Adq7a5GH8A3SWwCZSuEmQAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="summary"
        title="summary"
        src="/static/42fc74204812244be63f4b6dcd477123/50e4b/summary.png"
        srcset="/static/42fc74204812244be63f4b6dcd477123/c26ae/summary.png 158w,
/static/42fc74204812244be63f4b6dcd477123/6bdcf/summary.png 315w,
/static/42fc74204812244be63f4b6dcd477123/50e4b/summary.png 438w"
        sizes="(max-width: 438px) 100vw, 438px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></div></p>
<h2>Summary</h2>
<p>This has been a high-level breakdown of CVE 2020–0601 in the Microsoft crypto API that got disclosed to the world on the 14th of January 2020. This text has tried to demonstrate how a simple miss in validation can have a huge impact on the security of the Internet.</p>
<p>This post has also tried to show how this vulnerability can be exploited to generate malicious CA certificates, that in turn can be used to circumvent a lot of security features, like firewalls, website traffic etc.</p>
<p>Final last words are, always patch your systems… Always</p>
<h2>Appendix</h2>
<p>https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-0601</p>
<p>https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0601</p>
<p>https://krebsonsecurity.com/2020/01/cryptic-rumblings-ahead-of-first-2020-patch-tuesday/</p>
<p>https://twitter.com/saleemrash1d/status/1217495681230954506</p>
<p>https://github.com/ollypwn/CurveBall</p>
<p>https://www.secg.org/SEC2-Ver-1.0.pdf</p></section><div class="tagSection__StyledWrapper-sc-1aa460q-0 dnVzXH"><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->security</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->certificates</p></div><div class="Tag__StyledWrapper-sc-1wufizg-0 crIFBs"><p class="Tag__Text-sc-1wufizg-1 cjpKMj">#<!-- -->cve</p></div></div><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#181818;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/688f707e139e1c5b3b1adc848f4464fb/d4bf4/selfie.avif 50w,/static/688f707e139e1c5b3b1adc848f4464fb/ee81f/selfie.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/688f707e139e1c5b3b1adc848f4464fb/3faea/selfie.webp 50w,/static/688f707e139e1c5b3b1adc848f4464fb/6a679/selfie.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg" data-srcset="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg 50w,/static/688f707e139e1c5b3b1adc848f4464fb/64618/selfie.jpg 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/688f707e139e1c5b3b1adc848f4464fb/d4bf4/selfie.avif 50w,/static/688f707e139e1c5b3b1adc848f4464fb/ee81f/selfie.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/688f707e139e1c5b3b1adc848f4464fb/3faea/selfie.webp 50w,/static/688f707e139e1c5b3b1adc848f4464fb/6a679/selfie.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg" srcSet="/static/688f707e139e1c5b3b1adc848f4464fb/d24ee/selfie.jpg 50w,/static/688f707e139e1c5b3b1adc848f4464fb/64618/selfie.jpg 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><p>Written by <strong>Thomas Andolf</strong> <!-- -->I dont have twitter but i have<!-- --> <a href="https://www.linkedin.com/in/thomas-andolf-60966534">linkedin</a> <!-- -->and im on<!-- --> <a href="https://stackoverflow.com/users/1840146">stack overflow</a>.</p></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/monad-in-java/"><h3 class="styles__LinkText-sc-ncn1p3-0 jJcppV">← <!-- -->Write a Monad in java, seriously?</h3></a></li><li><a rel="next" href="/base64-in-rust/"><h3 class="styles__LinkText-sc-ncn1p3-0 jJcppV">Implementing base64 in rust<!-- --> →</h3></a></li></ul></nav></main><footer><h3 class="footer__FooterText-sc-ora8l1-0 gHswLm">© <!-- -->2023<!-- -->, Built by<!-- --> <a href="http://www.github.com/tandolf">toerktumlare</a></h3></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/cve-2020-0601/";window.___webpackCompilationHash="d47951f95e50548a2e50";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-afa68794cf9a69af341a.js"],"app":["/app-da0e5fbb4b5276d7ef81.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-6036be1a08e62eb825b9.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-72b717bd1ae7437cf1cd.js"],"component---src-pages-index-tsx":[],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-anatomy-of-dns-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-anatomy-of-dns-index-mdx-0979d3b4f78a5bb3a002.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-base-64-in-rust-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-base-64-in-rust-index-mdx-6acd2f2982af7e42be63.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-cve-2020-0601-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-cve-2020-0601-index-mdx-6e065da63338c67b563c.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-dns-compression-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-dns-compression-index-mdx-282ea2103896fd430f1f.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-hello-world-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-hello-world-index-mdx-da239a0014ab7f34b5e1.js"],"component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-monad-in-java-index-mdx":["/component---src-templates-blog-post-tsx-content-file-path-home-thomas-documents-code-js-blog-content-blog-monad-in-java-index-mdx-ba07fbb206a4681465a3.js"]};/*]]>*/</script><script src="/polyfill-afa68794cf9a69af341a.js" nomodule=""></script><script src="/app-da0e5fbb4b5276d7ef81.js" async=""></script><script src="/framework-20708a169de42a473112.js" async=""></script><script src="/webpack-runtime-7eedc861137ad0b97052.js" async=""></script></body></html>